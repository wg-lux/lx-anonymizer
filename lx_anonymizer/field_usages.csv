file,line,keyword,context,code
/home/admin/lx-anonymizer/lx_anonymizer/cropping_utils.py,155,anonymized_text,other,"original_text, anonymized_text, report_meta, cropped_regions = self.reader.process_report_with_cropping("
/home/admin/lx-anonymizer/lx_anonymizer/cropping_utils.py,173,patient_name,dict_key,"'patient_name': f""{report_meta.get('patient_first_name', '')} {report_meta.get('patient_last_name', '')}"".strip(),"
/home/admin/lx-anonymizer/lx_anonymizer/cropping_utils.py,173,patient_first_name,other,"'patient_name': f""{report_meta.get('patient_first_name', '')} {report_meta.get('patient_last_name', '')}"".strip(),"
/home/admin/lx-anonymizer/lx_anonymizer/cropping_utils.py,173,patient_last_name,other,"'patient_name': f""{report_meta.get('patient_first_name', '')} {report_meta.get('patient_last_name', '')}"".strip(),"
/home/admin/lx-anonymizer/lx_anonymizer/cropping_utils.py,174,case_number,dict_key,"'case_number': report_meta.get('casenumber'),"
/home/admin/lx-anonymizer/lx_anonymizer/cropping_utils.py,174,casenumber,other,"'case_number': report_meta.get('casenumber'),"
/home/admin/lx-anonymizer/lx_anonymizer/cropping_utils.py,175,patient_dob,dict_key,"'patient_dob': str(report_meta.get('patient_dob', '')),"
/home/admin/lx-anonymizer/lx_anonymizer/cropping_utils.py,175,patient_dob,dict_key,"'patient_dob': str(report_meta.get('patient_dob', '')),"
/home/admin/lx-anonymizer/lx_anonymizer/cropping_utils.py,252,patient_name,other,if meta.get('patient_name'):
/home/admin/lx-anonymizer/lx_anonymizer/cropping_utils.py,253,patient_name,other,"f.write(f""  Patient: {meta['patient_name']}\n"")"
/home/admin/lx-anonymizer/lx_anonymizer/cropping_utils.py,254,case_number,other,if meta.get('case_number'):
/home/admin/lx-anonymizer/lx_anonymizer/cropping_utils.py,255,case_number,other,"f.write(f""  Fallnummer: {meta['case_number']}\n"")"
/home/admin/lx-anonymizer/lx_anonymizer/cropping_utils.py,278,patient_name,dict_key,"""patient_name"": r""[A-ZÄÖÜ][a-zäöüß]+\s*,\s*[A-ZÄÖÜ][a-zäöüß]+"","
/home/admin/lx-anonymizer/lx_anonymizer/cropping_utils.py,280,case_number,dict_key,"""case_number"": r""(?:Fallnummer|Fallnr|Fall\.Nr)[:\s]*(\d+)"","
/home/admin/lx-anonymizer/lx_anonymizer/flair_NER.py,8,text,other,This script loads a Flair Named Entity Recognition (NER) tagger for German text.
/home/admin/lx-anonymizer/lx_anonymizer/flair_NER.py,11,text,other,input: text (str) - The text to be analyzed for entities.
/home/admin/lx-anonymizer/lx_anonymizer/flair_NER.py,11,text,other,input: text (str) - The text to be analyzed for entities.
/home/admin/lx-anonymizer/lx_anonymizer/flair_NER.py,12,text,other,output: entities (List) - A list of entities found in the text.
/home/admin/lx-anonymizer/lx_anonymizer/flair_NER.py,21,text,other,def flair_NER_German(text):
/home/admin/lx-anonymizer/lx_anonymizer/flair_NER.py,22,text,other,"if not isinstance(text, str):"
/home/admin/lx-anonymizer/lx_anonymizer/flair_NER.py,23,text,other,"logger.error(f""Expected a string, but got {type(text)}"")"
/home/admin/lx-anonymizer/lx_anonymizer/flair_NER.py,29,text,other,sentence = Sentence(text)
/home/admin/lx-anonymizer/lx_anonymizer/flair_NER.py,39,text,other,"logger.info(""A person tag ('PER') was found in the text. Replacing..."")"
/home/admin/lx-anonymizer/lx_anonymizer/flair_NER.py,41,text,other,"logger.info(""No person tag ('PER') was found in the text."")"
/home/admin/lx-anonymizer/lx_anonymizer/fuzzy_matching.py,16,text,other,"logger.debug(f""Fuzzy matching: snippet text: {snippet_text}"")"
/home/admin/lx-anonymizer/lx_anonymizer/fuzzy_matching.py,41,text,other,"If the new (corrected) text is significantly longer than the old text,"
/home/admin/lx-anonymizer/lx_anonymizer/fuzzy_matching.py,41,text,other,"If the new (corrected) text is significantly longer than the old text,"
/home/admin/lx-anonymizer/lx_anonymizer/fuzzy_matching.py,46,text,other,# Calculate the text size of the old and new text
/home/admin/lx-anonymizer/lx_anonymizer/fuzzy_matching.py,46,text,other,# Calculate the text size of the old and new text
/home/admin/lx-anonymizer/lx_anonymizer/fuzzy_matching.py,54,text,other,"# If the new text is significantly wider, expand the box horizontally"
/home/admin/lx-anonymizer/lx_anonymizer/fuzzy_matching.py,63,text,other,"# For instance, if new text has more lines, etc."
/home/admin/lx-anonymizer/lx_anonymizer/image_reassembly.py,3,uuid,other,import uuid
/home/admin/lx-anonymizer/lx_anonymizer/image_reassembly.py,12,id,other,"def reassemble_image(modified_images_map, output_dir, id, original_image_path=None):"
/home/admin/lx-anonymizer/lx_anonymizer/image_reassembly.py,20,id,other,id (str): An identifier used in the naming of the reassembled image file.
/home/admin/lx-anonymizer/lx_anonymizer/image_reassembly.py,73,id,other,"final_image_path = Path(output_dir) / f""reassembled_image_{id}_{uuid.uuid4()}.jpg"""
/home/admin/lx-anonymizer/lx_anonymizer/image_reassembly.py,73,uuid,other,"final_image_path = Path(output_dir) / f""reassembled_image_{id}_{uuid.uuid4()}.jpg"""
/home/admin/lx-anonymizer/lx_anonymizer/image_reassembly.py,92,id,variable_assignment,id = 'example_id'
/home/admin/lx-anonymizer/lx_anonymizer/image_reassembly.py,95,id,other,"reassemble_image(modified_images_map, output_dir, id, original_image_path)"
/home/admin/lx-anonymizer/lx_anonymizer/main_with_reassembly.py,1,uuid,other,import uuid
/home/admin/lx-anonymizer/lx_anonymizer/main_with_reassembly.py,26,text,other,The path to the EAST text detector model. Default is None.
/home/admin/lx-anonymizer/lx_anonymizer/main_with_reassembly.py,28,text,other,"The device name to set the correct text settings. Default is ""olympus_cv_1500""."
/home/admin/lx-anonymizer/lx_anonymizer/main_with_reassembly.py,118,uuid,other,"temp_pdf_path = Path(temp_dir) / f""temporary_pdf_{uuid.uuid4()}.pdf"""
/home/admin/lx-anonymizer/lx_anonymizer/main_with_reassembly.py,128,uuid,other,"final_pdf_path = Path(results_dir) / f""final_document_{uuid.uuid4()}.pdf"""
/home/admin/lx-anonymizer/lx_anonymizer/main_with_reassembly.py,149,text,other,"ap.add_argument(""-east"", ""--east"", type=str, required=False, help=""Path to input EAST text detector"")"
/home/admin/lx-anonymizer/lx_anonymizer/main_with_reassembly.py,150,text,other,"ap.add_argument(""-d"", ""--device"", type=str, default=""olympus_cv_1500"", help=""Device name to set the correct text settings"")"
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,80,text,other,"""text-generation"","
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,109,text,other,"""text-generation"","
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,197,text,other,"def correct_text_with_ollama(self, text):"
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,198,text,other,"""""""Use Ollama with current model to correct text"""""""
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,199,text,other,if not text:
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,200,text,other,"logger.warning(""No text provided for correction"")"
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,201,text,other,return text
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,202,text,other,"if not isinstance(text, str):"
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,203,text,other,"logger.error(f""Provided text is not a string but a {type(text)}"")"
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,203,text,other,"logger.error(f""Provided text is not a string but a {type(text)}"")"
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,206,text,variable_assignment,text = str(text)
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,206,text,variable_assignment,text = str(text)
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,212,text,other,# Use the ollama service to correct the text
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,213,text,other,return ollama_service.correct_ocr_text(text)
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,215,text,other,"def correct_text_with_ollama_in_chunks(self, text, chunk_size=2048):"
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,216,text,other,"""""""Use Ollama with current model to correct text in smaller chunks"""""""
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,219,text,other,return text
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,220,text,other,if not text:
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,221,text,other,"logger.warning(""No text provided for correction"")"
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,222,text,other,return text
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,223,text,other,"if not isinstance(text, str):"
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,224,text,other,"logger.error(""Provided text is not a string"")"
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,225,text,other,return text
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,226,text,other,# Use the ollama service to correct the text
/home/admin/lx-anonymizer/lx_anonymizer/model_service.py,227,text,other,return ollama_service.correct_ocr_text_in_chunks(text)
/home/admin/lx-anonymizer/lx_anonymizer/name_extractor_utils.py,4,text,other,def extract_name_from_patient_line(text):
/home/admin/lx-anonymizer/lx_anonymizer/name_extractor_utils.py,24,text,other,"match = re.search(pattern, text)"
/home/admin/lx-anonymizer/lx_anonymizer/name_extractor_utils.py,55,casenumber,dict_key,"'casenumber': None,"
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,4,text,other,def extract_patient_info_from_text(text):
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,7,patient_first_name,dict_key,"'patient_first_name': ""Unknown"","
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,8,patient_last_name,dict_key,"'patient_last_name': ""Unknown"","
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,9,patient_dob,dict_key,"'patient_dob': None,"
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,10,patient_gender,dict_key,"'patient_gender': ""Unknown"","
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,11,casenumber,dict_key,'casenumber': None
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,19,text,other,text (str): The full text from which to extract patient information
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,19,text,other,text (str): The full text from which to extract patient information
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,29,text,other,"match1 = re.search(pattern1, text, re.IGNORECASE)"
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,32,patient_last_name,other,info['patient_last_name'] = match1.group(1).strip()
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,33,patient_first_name,other,info['patient_first_name'] = match1.group(2).strip()
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,38,patient_dob,other,info['patient_dob'] = birth_date
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,44,casenumber,other,info['casenumber'] = match1.group(4).strip()
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,48,text,other,"context_window = text[max(0, text.find(info['patient_first_name']) - 30):"
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,48,text,other,"context_window = text[max(0, text.find(info['patient_first_name']) - 30):"
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,48,patient_first_name,other,"context_window = text[max(0, text.find(info['patient_first_name']) - 30):"
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,49,text,other,"min(len(text), text.find(info['patient_first_name']) + len(info['patient_first_name']) + 30)]"
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,49,text,other,"min(len(text), text.find(info['patient_first_name']) + len(info['patient_first_name']) + 30)]"
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,49,patient_first_name,other,"min(len(text), text.find(info['patient_first_name']) + len(info['patient_first_name']) + 30)]"
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,49,patient_first_name,other,"min(len(text), text.find(info['patient_first_name']) + len(info['patient_first_name']) + 30)]"
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,52,patient_gender,other,"info['patient_gender'] = ""female"""
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,54,patient_gender,other,"info['patient_gender'] = ""male"""
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,60,text,other,"match2 = re.search(pattern2, text, re.IGNORECASE)"
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,63,patient_last_name,other,info['patient_last_name'] = match2.group(1).strip()
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,64,patient_first_name,other,info['patient_first_name'] = match2.group(2).strip()
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,69,text,other,"match3 = re.search(pattern3, text, re.IGNORECASE)"
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,77,patient_first_name,other,info['patient_first_name'] = parts[0]
/home/admin/lx-anonymizer/lx_anonymizer/name_fallback.py,78,patient_last_name,other,"info['patient_last_name'] = "" "".join(parts[1:])"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,278,text,variable_assignment,"text=True,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,396,text,attribute_access,"error_msg = f""Failed to pull model '{self.model_name}': {response.text}"""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,432,text,attribute_access,"self._logger.warning(f""Model warm-up returned status {response.status_code}: {response.text}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,491,text,other,Generate text using the specified model.
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,499,text,other,Generated text or None if error
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,522,text,other,"logger.info(f""Generated text using model {self.model_name}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,525,text,attribute_access,"error_msg = f""Error generating text: {response.status_code} - {response.text}"""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,525,text,attribute_access,"error_msg = f""Error generating text: {response.status_code} - {response.text}"""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,533,text,other,"error_msg = f""Error generating text: {e}"""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,537,text,other,"def split_text_into_chunks(self, text, max_chunk_size=2048):"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,539,text,other,"Split text into smaller chunks, improved to handle large words and UTF-8."
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,542,text,other,text: The text to split
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,542,text,other,text: The text to split
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,546,text,other,List of text chunks
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,548,text,other,if not text:
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,552,text,other,"if isinstance(text, str):"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,554,text,other,text_bytes = text.encode(encoding)
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,556,text,other,text_bytes = text
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,591,text,other,"def correct_ocr_text(self, text):"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,593,text,other,Correct OCR text using an Ollama model.
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,596,text,other,text: The OCR text to correct
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,596,text,other,text: The OCR text to correct
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,599,text,other,Corrected text or original text on error
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,599,text,other,Corrected text or original text on error
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,607,text,other,# Ensure text is a string
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,608,text,other,"if not isinstance(text, str):"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,609,text,other,"logger.error(f""Expected string for text correction but got {type(text)}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,609,text,other,"logger.error(f""Expected string for text correction but got {type(text)}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,612,text,variable_assignment,text = str(text)
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,612,text,variable_assignment,text = str(text)
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,622,text,other,"f""{text!s}\n""  # !s ensures string conversion and escapes braces"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,646,text,attribute_access,"error_msg = f""Error correcting OCR text: {response.status_code} - {response.text}"""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,646,text,attribute_access,"error_msg = f""Error correcting OCR text: {response.status_code} - {response.text}"""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,654,text,other,"error_msg = f""Error correcting OCR text: {e}"""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,658,text,other,"def correct_ocr_text_in_chunks(self, text):"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,660,text,other,"Correct OCR text in chunks, for handling long texts."
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,663,text,other,text: The OCR text to correct
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,663,text,other,text: The OCR text to correct
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,666,text,other,Corrected text or original text on error
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,666,text,other,Corrected text or original text on error
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,674,text,other,# Split the text into chunks
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,675,text,other,text_chunks = self.split_text_into_chunks(text)
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,706,text,attribute_access,"error_msg = f""Error correcting OCR text chunk: {response.status_code} - {response.text}"""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,706,text,attribute_access,"error_msg = f""Error correcting OCR text chunk: {response.status_code} - {response.text}"""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,710,text,other,"logger.error(f""Error correcting OCR text chunk: {e}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,715,text,other,"logger.info(""OCR text correction completed."")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,718,text,other,"def extract_report_meta(self, text):"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,720,text,other,Extract metadata from the report text.
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,723,text,other,text: The report text to analyze
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,723,text,other,text: The report text to analyze
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,739,text,other,"f""{text!s}\n"""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,759,text,attribute_access,"error_msg = f""Error extracting report metadata: {response.status_code} - {response.text}"""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,774,text,other,"def _strip_code_fences(self, text):"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,775,text,other,"""""""Strip markdown code fences from the text if present."""""""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,776,text,other,if not text:
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,777,text,other,return text
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,779,text,other,"if text.startswith(""```"") and ""```"" in text[3:]:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,779,text,other,"if text.startswith(""```"") and ""```"" in text[3:]:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,781,text,other,"start_idx = text.find(""\n"", 3)"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,782,text,other,"end_idx = text.rfind(""```"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,784,text,other,return text[start_idx+1:end_idx].strip()
/home/admin/lx-anonymizer/lx_anonymizer/ollama_service.py,786,text,other,return text
/home/admin/lx-anonymizer/lx_anonymizer/phrase_combination.py,11,text,other,"for text, box in ocr_texts_with_boxes:"
/home/admin/lx-anonymizer/lx_anonymizer/phrase_combination.py,19,text,other,phrase = text
/home/admin/lx-anonymizer/lx_anonymizer/phrase_combination.py,23,text,other,"phrase += "" "" + text"
/home/admin/lx-anonymizer/lx_anonymizer/schema.py,7,patient_first_name,other,"patient_first_name: Optional[str] = Field(None, description=""Given name"")"
/home/admin/lx-anonymizer/lx_anonymizer/schema.py,8,patient_last_name,other,"patient_last_name:  Optional[str] = Field(None, description=""Family name"")"
/home/admin/lx-anonymizer/lx_anonymizer/schema.py,9,patient_gender,other,"patient_gender:     Optional[str] = Field(None, description=""m/f/div/unknown"")"
/home/admin/lx-anonymizer/lx_anonymizer/schema.py,10,patient_dob,other,patient_dob:        Optional[date] = None
/home/admin/lx-anonymizer/lx_anonymizer/schema.py,11,casenumber,other,casenumber:         Optional[str] = None
/home/admin/lx-anonymizer/lx_anonymizer/schema.py,13,patient_dob,other,"@field_validator('patient_dob', mode='before')"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,165,text,other,"def __call__(self, text: str) -> dict[str, str | None]:"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,170,text,other,doc = self._nlp(text)
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,178,text,attribute_access,"logger.debug(f""Matched span: '{span.text}'"")"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,183,text,variable_assignment,"comma_indices = [i for i, t in enumerate(tokens) if t.text == "",""]"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,189,text,attribute_access,if tokens[header_end_idx-1].text != ':':
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,201,text,attribute_access,last_name_filtered = [t.text for t in last_name_candidates if t.lower_ not in TITLE_WORDS]
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,202,text,attribute_access,first_name_filtered = [t.text for t in first_name_candidates if t.lower_ not in TITLE_WORDS]
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,209,text,attribute_access,"logger.warning(f""No comma found in matched span: '{span.text}'. Name splitting might be inaccurate."")"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,214,text,attribute_access,name_filtered = [t.text for t in name_candidates if t.lower_ not in TITLE_WORDS]
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,220,text,attribute_access,date_match = DATE_RE.search(span.text)
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,223,text,attribute_access,"date_token = next((t for t in tokens if t.idx >= span.start_char + date_match.start() and t.idx < span.start_char + date_match.end() and DATE_RE.fullmatch(t.text)), None)"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,229,text,attribute_access,birthdate_cleaned = _clean_date(date_token.text)
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,232,text,attribute_access,"logger.debug(f""Date '{date_token.text}' found but not preceded by expected keyword."")"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,234,text,attribute_access,birthdate_cleaned = _clean_date(date_token.text)
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,245,text,variable_assignment,"if next_token.text == "":"" and keyword_idx + 2 < len(tokens):"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,247,text,attribute_access,"if re.fullmatch(r""[\w/-]+"", potential_case_token.text):"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,249,text,attribute_access,"elif re.fullmatch(r""[\w/-]+"", next_token.text):"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,253,text,attribute_access,case_num = case_token.text
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,258,text,attribute_access,"potential_case_tokens = [t for i, t in enumerate(tokens) if i >= non_name_start_idx and re.fullmatch(r""[\w/-]+"", t.text) and t.text != birthdate]"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,258,text,attribute_access,"potential_case_tokens = [t for i, t in enumerate(tokens) if i >= non_name_start_idx and re.fullmatch(r""[\w/-]+"", t.text) and t.text != birthdate]"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,260,text,attribute_access,case_num = potential_case_tokens[0].text
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,265,patient_first_name,dict_key,"""patient_first_name"": first_name,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,266,patient_last_name,dict_key,"""patient_last_name"":  last_name,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,267,patient_dob,dict_key,"""patient_dob"":        birthdate,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,268,casenumber,dict_key,"""casenumber"":         case_num,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,269,patient_gender,dict_key,"""patient_gender"":     gender"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,278,patient_first_name,dict_key,"""patient_first_name"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,279,patient_last_name,dict_key,"""patient_last_name"":  None,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,280,patient_dob,dict_key,"""patient_dob"":        None,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,281,casenumber,dict_key,"""casenumber"":         None,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,282,patient_gender,dict_key,"""patient_gender"":     None"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,316,text,other,"def extract_examiner_info(self, text):"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,317,text,other,doc = self.nlp(text)
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,328,text,attribute_access,title = tokens[3].text
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,329,text,attribute_access,first_name = tokens[4].text
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,330,text,attribute_access,last_name = tokens[5].text
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,333,text,attribute_access,first_name = tokens[3].text
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,334,text,attribute_access,last_name = tokens[4].text
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,366,text,other,"def extract_endoscope_info(self, text):"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,367,text,other,doc = self.nlp(text)
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,378,text,attribute_access,"model_name = "" "".join([t.text for t in tokens[2:tokens.index(tokens[3])]])"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,379,text,attribute_access,serial_number = tokens[-1].text
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,397,text,other,"def extract_examination_info(self, text, remove_examiner_titles=True):"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,398,text,other,"if ""1. Unters.:"" in text or ""Unters.:"" in text:"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,398,text,other,"if ""1. Unters.:"" in text or ""Unters.:"" in text:"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,399,text,other,"return self._extract_meta_format_1(text, remove_examiner_titles)"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,401,text,other,"if ""Eingang am:"" in text:"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,402,text,other,"return self._extract_meta_format_2(text, remove_examiner_titles)"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,415,examiner_last_name,variable_assignment,examiner_last_name = match.group(1).strip()
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,416,examiner_first_name,variable_assignment,examiner_first_name = match.group(2).strip()
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,418,examination_date,variable_assignment,"examination_date = datetime.strptime(match.group(3), '%d.%m.%Y').strftime('%Y-%m-%d')"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,420,examination_time,variable_assignment,examination_time = match.group(4)
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,423,examiner_last_name,dict_key,"'examiner_last_name': examiner_last_name,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,423,examiner_last_name,dict_key,"'examiner_last_name': examiner_last_name,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,424,examiner_first_name,dict_key,"'examiner_first_name': examiner_first_name,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,424,examiner_first_name,dict_key,"'examiner_first_name': examiner_first_name,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,425,examination_date,dict_key,"'examination_date': examination_date,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,425,examination_date,dict_key,"'examination_date': examination_date,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,426,examination_time,dict_key,'examination_time': examination_time
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,426,examination_time,dict_key,'examination_time': examination_time
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,446,examination_date,variable_assignment,"examination_date = datetime.strptime(match.group(1), '%d.%m.%Y').strftime('%Y-%m-%d')"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,449,examiner_last_name,dict_key,"'examiner_last_name': """","
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,450,examiner_first_name,dict_key,"'examiner_first_name': """","
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,451,examination_date,dict_key,"'examination_date': examination_date,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,451,examination_date,dict_key,"'examination_date': examination_date,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_extractor.py,452,examination_time,dict_key,"'examination_time': """""
/home/admin/lx-anonymizer/lx_anonymizer/tesseract_text_detection.py,12,text,other,Detects text at word level using Tesseract OCR.
/home/admin/lx-anonymizer/lx_anonymizer/tesseract_text_detection.py,16,text,other,"logger.debug(""Loading tesseract text detection"")"
/home/admin/lx-anonymizer/lx_anonymizer/tesseract_text_detection.py,28,text,other,custom_config = r'--oem 3 --psm 11'  # PSM 11 for sparse text with OEM 3 (default)
/home/admin/lx-anonymizer/lx_anonymizer/tesseract_text_detection.py,30,text,other,# Detecting text using Tesseract with word-level configuration
/home/admin/lx-anonymizer/lx_anonymizer/tesseract_text_detection.py,47,text,other,# Loop over each of the individual text localizations
/home/admin/lx-anonymizer/lx_anonymizer/tesseract_text_detection.py,48,text,other,"for i in range(0, len(results[""text""])):"
/home/admin/lx-anonymizer/lx_anonymizer/tesseract_text_detection.py,53,text,variable_assignment,"text = results[""text""][i].strip()"
/home/admin/lx-anonymizer/lx_anonymizer/tesseract_text_detection.py,53,text,variable_assignment,"text = results[""text""][i].strip()"
/home/admin/lx-anonymizer/lx_anonymizer/tesseract_text_detection.py,55,text,other,# Filter out weak detections and empty text
/home/admin/lx-anonymizer/lx_anonymizer/tesseract_text_detection.py,57,text,other,text and  # Check if text is not empty
/home/admin/lx-anonymizer/lx_anonymizer/tesseract_text_detection.py,57,text,other,text and  # Check if text is not empty
/home/admin/lx-anonymizer/lx_anonymizer/tesseract_text_detection.py,58,text,other,not text.isspace() and  # Check if text is not just whitespace
/home/admin/lx-anonymizer/lx_anonymizer/tesseract_text_detection.py,58,text,other,not text.isspace() and  # Check if text is not just whitespace
/home/admin/lx-anonymizer/lx_anonymizer/tesseract_text_detection.py,78,text,dict_key,"""text"": text"
/home/admin/lx-anonymizer/lx_anonymizer/tesseract_text_detection.py,78,text,dict_key,"""text"": text"
/home/admin/lx-anonymizer/lx_anonymizer/tesseract_text_detection.py,90,text,other,"logger.info(f""Tesseract text detection complete. Found {len(output_boxes)} words."")"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,7,text,other,def replace_umlauts(text):
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,9,text,variable_assignment,"text = text.replace('ä', 'ae')"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,9,text,variable_assignment,"text = text.replace('ä', 'ae')"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,10,text,variable_assignment,"text = text.replace('ö', 'oe')"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,10,text,variable_assignment,"text = text.replace('ö', 'oe')"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,11,text,variable_assignment,"text = text.replace('ü', 'ue')"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,11,text,variable_assignment,"text = text.replace('ü', 'ue')"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,12,text,variable_assignment,"text = text.replace('Ä', 'AE')"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,12,text,variable_assignment,"text = text.replace('Ä', 'AE')"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,13,text,variable_assignment,"text = text.replace('Ö', 'OE')"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,13,text,variable_assignment,"text = text.replace('Ö', 'OE')"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,14,text,variable_assignment,"text = text.replace('Ü', 'UE')"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,14,text,variable_assignment,"text = text.replace('Ü', 'UE')"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,15,text,other,return text
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,17,text,other,def replace_large_numbers(text):
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,22,text,other,"numbers_to_replace = re.findall(r'\b\d{5,}\b', text)"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,27,text,variable_assignment,"text = text.replace(number, random_num)"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,27,text,variable_assignment,"text = text.replace(number, random_num)"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,29,text,other,return text
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,35,text,other,"def cutoff_leading_text(text, cutoff_flags):"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,37,text,other,Remove all text above the first occurrence of any cutoff flag.
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,40,text,other,"if not cutoff_flags:  # If no flags provided, return text as is"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,41,text,other,return text
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,43,text,other,lines = text.split('\n')
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,48,text,other,return text
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,50,text,other,"def cutoff_trailing_text(text, cutoff_flags):"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,52,text,other,Remove all text below the first occurrence of any cutoff flag.
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,55,text,other,"if not cutoff_flags:  # If no flags provided, return text as is"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,56,text,other,return text
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,58,text,other,lines = text.split('\n')
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,63,text,other,return text
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,65,text,other,"def replace_employee_names(text, first_names, last_names, locale=None):"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,70,text,other,if first_name and first_name in text:
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,71,text,variable_assignment,"text = text.replace(first_name, fake.first_name())"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,71,text,variable_assignment,"text = text.replace(first_name, fake.first_name())"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,75,text,other,if last_name and last_name in text:
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,76,text,variable_assignment,"text = text.replace(last_name, fake.last_name())"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,76,text,variable_assignment,"text = text.replace(last_name, fake.last_name())"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,78,text,other,return text
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,80,text,other,"def anonymize_text(text, report_meta, text_date_format=""%d.%m.%Y"","
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,85,text,other,Anonymizes the given text by replacing personal information.
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,88,text,other,text (str): The text to anonymize.
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,88,text,other,text (str): The text to anonymize.
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,90,text,other,text_date_format (str): Format for dates in the text.
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,91,text,other,lower_cut_off_flags (list): Markers to remove text after a given line.
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,92,text,other,upper_cut_off_flags (list): Markers to remove text before a given line.
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,96,text,other,apply_cutoffs (bool): Whether to apply text cutoffs.
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,100,text,other,str: Anonymized text.
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,103,text,other,"logger.info(""Starting text anonymization"")"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,105,anonymized_text,variable_assignment,anonymized_text = text
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,105,text,other,anonymized_text = text
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,108,patient_first_name,other,# nehmen wir hier z.B. patient_first_name und patient_last_name:
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,108,patient_last_name,other,# nehmen wir hier z.B. patient_first_name und patient_last_name:
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,109,patient_first_name,other,"if report_meta.get(""patient_first_name"") and report_meta.get(""patient_last_name""):"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,109,patient_last_name,other,"if report_meta.get(""patient_first_name"") and report_meta.get(""patient_last_name""):"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,110,patient_first_name,other,"first_name = report_meta[""patient_first_name""]"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,111,patient_last_name,other,"last_name = report_meta[""patient_last_name""]"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,114,anonymized_text,variable_assignment,"anonymized_text = anonymized_text.replace(first_name, pseudo_first_name)"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,114,anonymized_text,variable_assignment,"anonymized_text = anonymized_text.replace(first_name, pseudo_first_name)"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,115,anonymized_text,variable_assignment,"anonymized_text = anonymized_text.replace(last_name, pseudo_last_name)"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,115,anonymized_text,variable_assignment,"anonymized_text = anonymized_text.replace(last_name, pseudo_last_name)"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,118,examiner_first_name,other,"if report_meta.get(""examiner_first_name"") and report_meta.get(""examiner_last_name""):"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,118,examiner_last_name,other,"if report_meta.get(""examiner_first_name"") and report_meta.get(""examiner_last_name""):"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,119,examiner_first_name,variable_assignment,"examiner_first_name = report_meta[""examiner_first_name""]"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,119,examiner_first_name,variable_assignment,"examiner_first_name = report_meta[""examiner_first_name""]"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,120,examiner_last_name,variable_assignment,"examiner_last_name = report_meta[""examiner_last_name""]"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,120,examiner_last_name,variable_assignment,"examiner_last_name = report_meta[""examiner_last_name""]"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,123,anonymized_text,variable_assignment,"anonymized_text = anonymized_text.replace(examiner_first_name, pseudo_examiner_first_name)"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,123,anonymized_text,variable_assignment,"anonymized_text = anonymized_text.replace(examiner_first_name, pseudo_examiner_first_name)"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,123,examiner_first_name,other,"anonymized_text = anonymized_text.replace(examiner_first_name, pseudo_examiner_first_name)"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,124,anonymized_text,variable_assignment,"anonymized_text = anonymized_text.replace(examiner_last_name, pseudo_examiner_last_name)"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,124,anonymized_text,variable_assignment,"anonymized_text = anonymized_text.replace(examiner_last_name, pseudo_examiner_last_name)"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,124,examiner_last_name,other,"anonymized_text = anonymized_text.replace(examiner_last_name, pseudo_examiner_last_name)"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,125,examiner_first_name,other,"logger.debug(f""Replaced examiner name: {examiner_first_name} {examiner_last_name} -> {pseudo_examiner_first_name} {pseudo_examiner_last_name}"")"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,125,examiner_last_name,other,"logger.debug(f""Replaced examiner name: {examiner_first_name} {examiner_last_name} -> {pseudo_examiner_first_name} {pseudo_examiner_last_name}"")"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,129,text,other,"logger.info(""Applying text cutoffs"")"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,132,anonymized_text,variable_assignment,"anonymized_text = cutoff_leading_text(anonymized_text, upper_cut_off_flags)"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,132,anonymized_text,variable_assignment,"anonymized_text = cutoff_leading_text(anonymized_text, upper_cut_off_flags)"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,136,anonymized_text,variable_assignment,"anonymized_text = cutoff_trailing_text(anonymized_text, lower_cut_off_flags)"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,136,anonymized_text,variable_assignment,"anonymized_text = cutoff_trailing_text(anonymized_text, lower_cut_off_flags)"
/home/admin/lx-anonymizer/lx_anonymizer/text_anonymizer.py,140,anonymized_text,other,return anonymized_text
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,14,text,other,"def _calculate_text_quality_score(self, text: str, confidence: float) -> float:"
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,15,text,other,if not text:
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,22,text,other,"words = re.findall(r""[A-Za-zÄÖÜäöüß]{2,}"", text)"
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,24,text,other,# Medical text patterns
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,34,text,other,"if re.search(pattern, text, re.IGNORECASE):"
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,51,text,other,punct_count = sum(1 for ch in text if ch in punct_chars)
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,52,text,other,punct_ratio = punct_count / len(text)
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,60,text,other,"length_bonus = min(len(text) / 100, 0.1)"
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,65,text,other,"def _is_quality_text(self, text: str) -> bool:"
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,66,text,other,if not text or len(text) < 3:
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,66,text,other,if not text or len(text) < 3:
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,70,text,other,special_chars = sum(1 for ch in text if ord(ch) > 127 and not ch.isalpha())
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,71,text,other,if special_chars > len(text) * 0.3:
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,75,text,other,"words = re.findall(r""[A-Za-zÄÖÜäöüß]{2,}"", text)"
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,80,text,other,"def push(self, text: str, confidence: float, metadata: Optional[Dict[str, Any]] = None) -> None:"
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,83,text,other,if not self._is_quality_text(text):
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,84,text,other,"logger.debug(f""Rejected low-quality text: {text[:50]}..."")"
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,84,text,other,"logger.debug(f""Rejected low-quality text: {text[:50]}..."")"
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,87,text,other,"quality_score = self._calculate_text_quality_score(text, confidence)"
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,90,text,dict_key,"'text': text,"
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,90,text,dict_key,"'text': text,"
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,108,text,dict_key,"'text': text,"
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,108,text,dict_key,"'text': text,"
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,110,text,other,"'quality_score': len(text),"
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,116,text,other,# Sort by text length
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,117,text,other,"self.candidates.sort(key=lambda x: len(x['text']), reverse=True)"
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,128,text,other,"logger.info(f""Best text selected with quality score: {best_candidate['quality_score']:.3f}"")"
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,130,text,other,return best_candidate['text']
/home/admin/lx-anonymizer/lx_anonymizer/enhanced_best_frame_text.py,150,text,other,"""best_candidate_length"": len(self.candidates[0]['text']) if self.candidates else 0,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,2,text,other,Ollama-based LLM integration for image processing and text analysis.
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,9,uuid,other,import uuid
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,24,text,other,Ollama-based LLM processor for image analysis and text processing.
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,170,text,other,"""context"": ""surrounding text or context"""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,205,text,other,Parse names from Ollama response text.
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,208,text,other,response_text: Raw response text from Ollama
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,223,text,other,# Fallback: parse structured text
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,250,text,other,"def analyze_text_for_names(self, text: str, context: Optional[str] = None) -> List[Dict]:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,252,text,other,Analyze text for person names using Ollama text model.
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,252,text,other,Analyze text for person names using Ollama text model.
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,255,text,other,text: Text to analyze
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,265,text,other,Analyze the following text from a medical document and extract all person names.
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,268,text,other,{text}
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,286,text,other,"""context"": ""surrounding text"""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,305,text,other,"logger.info(f""Extracted {len(names_data)} names from text using Ollama"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,309,text,other,"logger.error(f""Error analyzing text with Ollama: {e}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,380,validated,variable_assignment,validated = []
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,382,validated,other,validated.append({
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,391,validated,other,return validated
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,441,text,other,# Extract full text using Tesseract for additional context
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,447,text,other,"logger.warning(f""Could not extract full text: {e}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,458,uuid,other,"analysis_csv_path = csv_dir / f""ollama_analysis_{image_path.stem}_{uuid.uuid4().hex[:8]}.csv"""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,534,text,other,"def analyze_text_with_ollama(text: str, csv_path: Optional[Path] = None,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,537,text,other,Analyze text with Ollama (replacement for analyze_text_with_phi4).
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,540,text,other,text: Text to analyze
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,560,text,other,# Analyze text
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,561,text,other,"name_entries = processor.analyze_text_for_names(text, context)"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_processor.py,569,text,other,"logger.error(f""Error analyzing text with Ollama: {e}"")"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_NER.py,13,text,other,def spacy_NER_German(text):
/home/admin/lx-anonymizer/lx_anonymizer/spacy_NER.py,16,text,other,"if not isinstance(text, str):"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_NER.py,17,text,other,"logger.error(f""Expected a string, but got {type(text)}"")"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_NER.py,40,text,other,doc = nlp(text)
/home/admin/lx-anonymizer/lx_anonymizer/spacy_NER.py,41,text,attribute_access,"entities = [(ent.text, ent.start_char, ent.end_char, ent.label_) for ent in doc.ents]"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_NER.py,43,text,attribute_access,"print(token.text, token.pos_, token.dep_)"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_NER.py,53,text,other,"logger.info(""A person tag ('PER') was found in the text. Replacing..."")"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_NER.py,55,text,other,"logger.info(""No person tag ('PER') was found in the text."")"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,39,patient_first_name,dict_key,"""patient_first_name"": r""patient_first_name"","
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,39,patient_first_name,dict_key,"""patient_first_name"": r""patient_first_name"","
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,40,patient_last_name,dict_key,"""patient_last_name"":  r""patient_last_name"","
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,40,patient_last_name,dict_key,"""patient_last_name"":  r""patient_last_name"","
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,41,patient_dob,dict_key,"""patient_dob"":        r""(?:patient_)?(?:dob|geb(?:urtsdatum)?)"","
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,42,casenumber,dict_key,"""casenumber"":         r""(?:case)?number"","
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,43,patient_gender,dict_key,"""patient_gender"":     r""(?:patient_)?gender"","
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,59,text,other,"def regex_extract_llm_meta(self, text: str) -> dict[str, str | None]:"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,62,casenumber,other,first name / last name / dob / casenumber / gender.
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,67,text,other,doc = self.nlp(text)
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,73,text,attribute_access,"m = re.search(self._VALUE, ent.text)"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,78,patient_dob,dict_key,"if key == ""patient_dob"":"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,84,patient_first_name,other,"for k in (""patient_first_name"", ""patient_last_name""):"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,84,patient_last_name,other,"for k in (""patient_first_name"", ""patient_last_name""):"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,148,text,other,"def patient_data_extractor(self, text):"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,150,text,other,return self.extract_patient_info(text)
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,152,text,other,"def extract_patient_info(self, text):"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,156,text,other,doc = self.nlp(text)
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,171,casenumber,variable_assignment,"first_name, last_name, birthdate, casenumber = None, None, None, None"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,174,text,variable_assignment,"comma_indices = [i for i, token in enumerate(span) if token.text == "",""]"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,177,text,attribute_access,"date_indices = [i for i, token in enumerate(span) if DATE_RE.match(token.text)]"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,178,text,attribute_access,"case_num_indices = [i for i, token in enumerate(span) if NUMBER_RE.match(token.text) and i > 0 and span[i-1].lower_ in ["":"", ""fallnr"", ""fallnr."", ""fallnummer""]]"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,185,text,variable_assignment,if span[1].text == ':':
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,188,text,attribute_access,last_name_tokens = [t.text for t in span[name_start_idx:comma_idx] if t.is_title]
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,194,text,attribute_access,first_name_tokens = [t.text for t in span[comma_idx + 1 : name_end_idx] if t.is_title]
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,211,text,attribute_access,birthdate_str = span[date_idx].text
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,230,casenumber,variable_assignment,casenumber = span[num_idx].text
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,230,text,attribute_access,casenumber = span[num_idx].text
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,236,patient_first_name,dict_key,"""patient_first_name"": first_name,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,237,patient_last_name,dict_key,"""patient_last_name"": last_name,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,238,patient_dob,dict_key,"""patient_dob"": birthdate,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,239,casenumber,dict_key,"""casenumber"": casenumber,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,239,casenumber,dict_key,"""casenumber"": casenumber,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,240,patient_gender,dict_key,"""patient_gender"": gender"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,245,patient_first_name,dict_key,"""patient_first_name"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,246,patient_last_name,dict_key,"""patient_last_name"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,247,patient_dob,dict_key,"""patient_dob"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,248,casenumber,dict_key,"""casenumber"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,249,patient_gender,dict_key,"""patient_gender"": None"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,252,text,other,"def _extract_using_entity_ruler(self, text):"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,259,text,other,doc = self.nlp(text)
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,270,text,attribute_access,"person_ents = [ent.text for ent in doc.ents if ent.label_ == ""PER""]"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,276,patient_first_name,dict_key,"'patient_first_name': ""Unknown"","
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,277,patient_last_name,dict_key,"'patient_last_name': ""Unknown"","
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,279,casenumber,dict_key,"'casenumber': None,"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,280,patient_gender,dict_key,"'patient_gender': ""Unknown"""
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,283,text,other,"def examiner_data_extractor(self, text):"
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,302,text,other,doc = self.nlp(text)
/home/admin/lx-anonymizer/lx_anonymizer/spacy_regex.py,306,text,attribute_access,return ent.text
/home/admin/lx-anonymizer/lx_anonymizer/video_processing_service.py,28,text,variable_assignment,"subprocess.run(cmd, capture_output=True, text=True, check=True)"
/home/admin/lx-anonymizer/lx_anonymizer/video_processing_service.py,59,text,variable_assignment,"subprocess.run(cmd, capture_output=True, text=True, check=True)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,9,id,other,python ocr_diagnostic.py --video-id 23 --output-dir ./debug/ocr
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,61,text,variable_assignment,"stderr=subprocess.STDOUT, text=True)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,66,text,variable_assignment,"stderr=subprocess.STDOUT, text=True)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,81,text,other,"def analyze_text_quality(self, text: str) -> Dict[str, Any]:"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,83,text,other,if not text:
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,88,text,variable_assignment,"text = unicodedata.normalize(""NFKC"", text)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,88,text,variable_assignment,"text = unicodedata.normalize(""NFKC"", text)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,92,text,other,letters = sum(1 for ch in text if ch.isalpha())
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,93,text,other,digits = sum(1 for ch in text if ch.isdigit())
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,94,text,other,punct = sum(1 for ch in text if ch in punct_chars)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,95,text,other,whitespace = sum(1 for ch in text if ch.isspace())
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,98,text,other,"words = re.findall(r""[A-Za-zÄÖÜäöüß]{2,}"", text)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,102,text,other,"repeated_chars = len(re.findall(r""(.)\1{3,}"", text))  # 4+ gleiche Zeichen hintereinander"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,103,text,other,special_symbols = sum(1 for ch in text if ord(ch) > 127 and not ch.isalpha())
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,106,text,other,"""len"": len(text),"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,111,text,other,"""punct_ratio"": punct / max(1, len(text)),"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,116,text,other,"""text_sample"": text[:100].replace(""\n"", ""\\n"")"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,138,text,other,"for i, word in enumerate(ocr_data['text']):"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,145,text,variable_assignment,text = ' '.join(words)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,149,text,other,quality = self.analyze_text_quality(text)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,154,text,dict_key,"""text"": text,"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,154,text,dict_key,"""text"": text,"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,171,text,dict_key,"""text"": """","
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,301,text,other,"f.write(""- Check if ROI is correctly positioned over text areas\n"")"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_diagnostic.py,374,id,other,"parser.add_argument(""--video-id"", required=True, help=""Video ID for reporting"")"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,33,text,other,to avoid cutting through text.
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,39,text,other,overlap: Overlap between chunks to avoid cutting text
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,134,text,other,Extracted text string
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,139,text,other,# Generate text with enhanced parameters
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,155,text,other,# Get text and confidence
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,162,text,other,Post-process and merge text from multiple chunks intelligently.
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,165,text,other,1. Removing duplicate text at chunk boundaries
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,167,text,other,3. Sorting text blocks by their position in the document
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,170,text,other,chunk_texts: List of text strings from each chunk
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,174,text,other,Merged and cleaned text
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,185,text,other,# Find and remove duplicate text segments
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,187,text,other,"for i, (text, _) in enumerate(positioned_texts):"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,188,text,other,if not text.strip():
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,192,text,other,current_text = text
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,198,text,other,# Skip if either text is too short
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,202,text,other,# Check for overlap at beginning of current text
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,218,text,other,"result = ""\n\n"".join(text for text in processed_texts if text.strip())"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,218,text,other,"result = ""\n\n"".join(text for text in processed_texts if text.strip())"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,218,text,other,"result = ""\n\n"".join(text for text in processed_texts if text.strip())"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,238,text,other,A string of the recognized text.
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,371,text,variable_assignment,text = donut_full_image_ocr(image_path)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,372,text,other,"print(f""Extracted text:\n{text}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_donut.py,372,text,other,"print(f""Extracted text:\n{text}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_field_validation.py,42,examiner_first_name,other,"field_type: Literal[""examiner_first_name"", ""examiner_last_name"", ""first_name"", ""last_name"", ""dob"", ""casenumber"", ""center""],"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_field_validation.py,42,examiner_last_name,other,"field_type: Literal[""examiner_first_name"", ""examiner_last_name"", ""first_name"", ""last_name"", ""dob"", ""casenumber"", ""center""],"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_field_validation.py,42,casenumber,other,"field_type: Literal[""examiner_first_name"", ""examiner_last_name"", ""first_name"", ""last_name"", ""dob"", ""casenumber"", ""center""],"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_field_validation.py,49,casenumber,other,"field_type: One of 'examiner', 'first_name', 'last_name', 'dob', 'casenumber', 'center'"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_field_validation.py,67,examiner_first_name,other,"if field_type in {""examiner_first_name"", ""examiner_last_name"", ""first_name"", ""last_name""}:"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_field_validation.py,67,examiner_last_name,other,"if field_type in {""examiner_first_name"", ""examiner_last_name"", ""first_name"", ""last_name""}:"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_field_validation.py,72,examiner_first_name,other,"if field_type in {""first_name"", ""last_name"", ""examiner_first_name"", ""examiner_last_name""}:"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_field_validation.py,72,examiner_last_name,other,"if field_type in {""first_name"", ""last_name"", ""examiner_first_name"", ""examiner_last_name""}:"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_field_validation.py,96,casenumber,dict_key,"elif field_type == ""casenumber"":"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_field_validation.py,99,casenumber,other,"logger.debug(f""Rejected casenumber: invalid characters ({value})"")"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,2,text,other,Enhanced FrameOCR with diagnostic capabilities for gibberish text detection.
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,49,text,variable_assignment,"[""tesseract"", ""--version""], stderr=subprocess.STDOUT, text=True"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,54,text,variable_assignment,"[""tesseract"", ""--list-langs""], stderr=subprocess.STDOUT, text=True"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,70,text,other,"def _analyze_text_quality(self, text: str) -> Dict[str, Any]:"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,71,text,other,"""""""Analyze OCR text quality and detect gibberish patterns."""""""
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,72,text,other,if not text:
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,80,text,variable_assignment,"text = unicodedata.normalize(""NFKC"", text)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,80,text,variable_assignment,"text = unicodedata.normalize(""NFKC"", text)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,87,text,other,letters = sum(1 for ch in text if ch.isalpha())
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,88,text,other,digits = sum(1 for ch in text if ch.isdigit())
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,89,text,other,punct = sum(1 for ch in text if ch in all_punct)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,90,text,other,whitespace = sum(1 for ch in text if ch.isspace())
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,93,text,other,"words = re.findall(r""[A-Za-zÄÖÜäöüß]{2,}"", text)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,97,text,other,"punct_ratio = punct / max(1, len(text))"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,98,text,other,"repeated_chars = len(re.findall(r""(.)\1{3,}"", text))"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,99,text,other,special_symbols = sum(1 for ch in text if ord(ch) > 127 and not ch.isalpha())
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,109,text,other,if special_symbols > len(text) * 0.2:
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,115,text,other,"""len"": len(text),"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,192,text,other,"""""""Extract text with diagnostic capabilities and gibberish detection."""""""
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,213,text,other,"for i, word in enumerate(ocr_data['text']):"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,221,text,variable_assignment,text = ' '.join(words)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,224,text,other,# Analyze text quality
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,225,text,other,quality = self._analyze_text_quality(text)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,229,text,other,"self._log_diagnostic_sample(frame_id, processed_frame, text, mean_conf, quality, roi)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,233,text,other,"logger.warning(f""High gibberish score ({quality['gibberish_score']:.2f}) detected: {text[:50]}..."")"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,242,text,other,"text, mean_conf = alternative_text, alternative_conf"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,247,text,other,"return text, mean_conf, ocr_data"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,269,text,other,"for i, word in enumerate(ocr_data['text']):"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,276,text,variable_assignment,text = ' '.join(words)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,279,text,other,"return text, mean_conf"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,286,text,other,"text: str, confidence: float, quality: Dict, roi: Optional[Dict]):"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,300,text,dict_key,"""text"": text[:200],"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_enhanced.py,300,text,dict_key,"""text"": text[:200],"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_GOT.py,34,text,other,str: The extracted text from the image.
/home/admin/lx-anonymizer/lx_anonymizer/ocr_multi_scale.py,25,text,other,str - Combined OCR text
/home/admin/lx-anonymizer/lx_anonymizer/ocr_multi_scale.py,52,text,other,# PSM 6: Assume a single uniform block of text
/home/admin/lx-anonymizer/lx_anonymizer/ocr_multi_scale.py,57,text,other,# Extract text and data for confidence calculation
/home/admin/lx-anonymizer/lx_anonymizer/ocr_multi_scale.py,58,text,variable_assignment,"text = pytesseract.image_to_string(processed_image, config=config)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_multi_scale.py,72,text,other,results.append(text)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_multi_scale.py,78,text,other,"""text_length"": len(text),"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_multi_scale.py,79,text,other,"""word_count"": len(text.split()),"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_multi_scale.py,83,text,other,"f""Scale {scale} - Confidence: {avg_confidence:.2f}, Text length: {len(text)}"""
/home/admin/lx-anonymizer/lx_anonymizer/ocr_multi_scale.py,118,text,other,- 'blocks': Use Tesseract to find text blocks
/home/admin/lx-anonymizer/lx_anonymizer/ocr_multi_scale.py,128,text,other,str - Combined OCR text from all segments
/home/admin/lx-anonymizer/lx_anonymizer/ocr_multi_scale.py,140,text,other,# Use Tesseract to find text blocks
/home/admin/lx-anonymizer/lx_anonymizer/ocr_multi_scale.py,147,text,other,"for i in range(len(data[""text""])):"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_multi_scale.py,148,text,other,"if data[""text""][i].strip():"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_multi_scale.py,154,text,dict_key,"""text"": data[""text""][i],"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_multi_scale.py,154,text,dict_key,"""text"": data[""text""][i],"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_multi_scale.py,167,text,other,# Extract text from each block
/home/admin/lx-anonymizer/lx_anonymizer/ocr_multi_scale.py,170,text,other,"block_text = "" "".join(word[""text""] for word in block)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_multi_scale.py,274,text,other,"text, _ = pyramid_ocr(image, scales=[0.5, 0.75, 1.0])"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_multi_scale.py,275,text,other,return text
/home/admin/lx-anonymizer/lx_anonymizer/ocr_preprocessing.py,139,text,other,# Enhance contrast to make text more visible
/home/admin/lx-anonymizer/lx_anonymizer/ocr_preprocessing.py,143,text,other,# Apply sharpening multiple times to enhance text edges
/home/admin/lx-anonymizer/lx_anonymizer/ocr_preprocessing.py,150,text,other,# Apply Otsu's thresholding to separate text from background
/home/admin/lx-anonymizer/lx_anonymizer/ocr_preprocessing.py,157,text,other,# Enhance text edges
/home/admin/lx-anonymizer/lx_anonymizer/ocr_preprocessing.py,210,text,other,Special preprocessing for images that may contain handwritten text.
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,32,text,other,text: str
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,42,text,other,"- score(text, conf) -> float in [0,1]"
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,75,text,other,"def _quality_score(self, text: str, conf: float) -> float:"
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,76,text,other,if not text:
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,83,text,other,words = _WORD_RX.findall(text)
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,86,text,other,med_bonus = sum(0.1 for rx in _MEDICAL_RXS if rx.search(text))
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,100,text,other,if len(text) >= 4:
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,101,text,other,punct = sum(1 for ch in text if _is_punct_or_symbol(ch))
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,102,text,other,pr = punct / len(text)
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,109,text,other,"score += min(len(text) / 1000.0, 0.1)"
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,131,text,other,"def push(self, text: str, ocr_conf: float, *, is_sensitive: Optional[bool] = None, metadata: Optional[Dict[str, Any]] = None) -> None:"
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,132,text,other,if not text:
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,137,text,other,if ocr_conf < self.min_conf or len(text) < self.min_len:
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,139,text,other,"s = min(1.0, (len(text) / 2000.0) + max(0.0, min(1.0, ocr_conf)) * 0.25)"
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,141,text,other,"s = self._quality_score(text, ocr_conf)"
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,143,text,other,if not is_sensitive and (ocr_conf < self.min_conf or len(text) < self.min_len or s < 0.25):
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,146,text,variable_assignment,"cand = Candidate(text=text, conf=ocr_conf, score=s, meta=metadata or {})"
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,146,text,variable_assignment,"cand = Candidate(text=text, conf=ocr_conf, score=s, meta=metadata or {})"
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,155,text,attribute_access,"return self._topk[0].text if self._topk else """""
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,169,text,variable_assignment,"text = """""
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,171,text,other,"text += c.meta.get(""extracted_metadata"", """")"
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,172,text,other,if text:
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,173,text,other,meta = self.ollama_extraction.extract_metadata(text)
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,178,text,attribute_access,"average = ""\n\n"".join(c.text for c in random.sample(self._reservoir, min(preview_size, len(self._reservoir))))[:1500]"
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,186,text,attribute_access,"best = self._topk[0].text if self._topk else max(self._reservoir, key=lambda c: len(c.text)).text"
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,186,text,attribute_access,"best = self._topk[0].text if self._topk else max(self._reservoir, key=lambda c: len(c.text)).text"
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,186,text,attribute_access,"best = self._topk[0].text if self._topk else max(self._reservoir, key=lambda c: len(c.text)).text"
/home/admin/lx-anonymizer/lx_anonymizer/best_frame_text.py,190,text,attribute_access,"average = ""\n\n"".join(c.text for c in samples)[:1500]"
/home/admin/lx-anonymizer/lx_anonymizer/blur.py,1,uuid,other,import uuid
/home/admin/lx-anonymizer/lx_anonymizer/blur.py,75,uuid,other,"output_image_path = Path(blur_dir) / f""{uuid.uuid4().hex}.png"""
/home/admin/lx-anonymizer/lx_anonymizer/box_operations.py,19,text,other,"ocr_results: List of (text, box)"
/home/admin/lx-anonymizer/lx_anonymizer/box_operations.py,20,text,other,Returns only entries where text length >= min_text_len
/home/admin/lx-anonymizer/lx_anonymizer/box_operations.py,23,text,other,"for text, box in ocr_results:"
/home/admin/lx-anonymizer/lx_anonymizer/box_operations.py,24,text,other,if len(text.strip()) >= min_text_len:
/home/admin/lx-anonymizer/lx_anonymizer/box_operations.py,25,text,other,"filtered.append((text, box))"
/home/admin/lx-anonymizer/lx_anonymizer/box_operations.py,71,text,other,# Get the text size of the name
/home/admin/lx-anonymizer/lx_anonymizer/box_operations.py,157,text,other,"""""""Dynamic box creation based on text length"""""""
/home/admin/lx-anonymizer/lx_anonymizer/box_operations.py,161,text,other,# Calculate required width based on text length
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,83,hash,other,"""""""Calculates the SHA256 hash of a PDF file."""""""
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,97,hash,other,"logger.error(f""Could not calculate PDF hash for {report_file_path.name}: [Errno 2] No such file or directory: '{pdf_file_path}'"")"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,100,hash,other,"logger.error(f""Error calculating hash for {pdf_file_path}: {e}"")"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,111,hash,other,# Calculate PDF hash using the full path
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,123,id,other,"report_id = report_data.get(""id"", ""UnknownID"")  # Get report ID or use a default"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,124,text,other,"header_line = reader.find_header_line(report_data.get(""text"", """"))"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,127,patient_last_name,other,"if patient_info.get(""patient_last_name"") or patient_info.get(""patient_first_name""):"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,127,patient_first_name,other,"if patient_info.get(""patient_last_name"") or patient_info.get(""patient_first_name""):"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,132,patient_first_name,other,"""first_name"": patient_info.get(""patient_first_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,133,patient_last_name,other,"""last_name"": patient_info.get(""patient_last_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,180,raw_text,other,"raw_text: str = obj.get(""report"", """")"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,181,raw_text,other,if not raw_text:
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,190,raw_text,other,"extracted_meta = rr.extract_report_meta_deepseek(raw_text, fp)"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,192,raw_text,other,"extracted_meta = rr.extract_report_meta_medllama(raw_text, fp)"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,194,raw_text,other,"extracted_meta = rr.extract_report_meta_llama3(raw_text, fp)"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,197,raw_text,other,"extracted_meta = rr.extract_report_meta(raw_text, fp)"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,201,raw_text,other,"extracted_meta = rr.extract_report_meta(raw_text, fp)"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,204,raw_text,other,"extracted_meta = rr.extract_report_meta(raw_text, fp)"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,209,patient_first_name,other,"""first_name"": extracted_meta.get(""patient_first_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,210,patient_last_name,other,"""last_name"": extracted_meta.get(""patient_last_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,211,patient_dob,other,"""dob"": str(extracted_meta.get(""patient_dob"")) if extracted_meta.get(""patient_dob"") else None,"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,211,patient_dob,other,"""dob"": str(extracted_meta.get(""patient_dob"")) if extracted_meta.get(""patient_dob"") else None,"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,212,patient_gender,other,"""gender"": extracted_meta.get(""patient_gender""),"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,213,casenumber,dict_key,"""casenumber"": extracted_meta.get(""casenumber""),"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,213,casenumber,dict_key,"""casenumber"": extracted_meta.get(""casenumber""),"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,237,anonymized_text,other,"original_text, anonymized_text, extracted_meta = rr.process_report(pdf_path=fp, use_llm_extractor=llm_extractor)"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,246,patient_first_name,other,"""first_name"": extracted_meta.get(""patient_first_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,247,patient_last_name,other,"""last_name"": extracted_meta.get(""patient_last_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,248,patient_dob,other,"""dob"": str(extracted_meta.get(""patient_dob"")) if extracted_meta.get(""patient_dob"") else None,"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,248,patient_dob,other,"""dob"": str(extracted_meta.get(""patient_dob"")) if extracted_meta.get(""patient_dob"") else None,"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,249,patient_gender,other,"""gender"": extracted_meta.get(""patient_gender""),"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,250,casenumber,dict_key,"""casenumber"": extracted_meta.get(""casenumber""),"
/home/admin/lx-anonymizer/lx_anonymizer/collect_patient_names.py,250,casenumber,dict_key,"""casenumber"": extracted_meta.get(""casenumber""),"
/home/admin/lx-anonymizer/lx_anonymizer/craft_text_detection.py,19,text,other,Performs CRAFT text detection on the input image.
/home/admin/lx-anonymizer/lx_anonymizer/craft_text_detection.py,26,text,other,and the text detection model.
/home/admin/lx-anonymizer/lx_anonymizer/craft_text_detection.py,54,text,other,"logger.info(""Running CRAFT text detection..."")"
/home/admin/lx-anonymizer/lx_anonymizer/craft_text_detection.py,65,text,other,# Filtering parameters for text regions.
/home/admin/lx-anonymizer/lx_anonymizer/craft_text_detection.py,111,text,other,"logger.info(f""Detected {len(output_boxes)} text regions"")"
/home/admin/lx-anonymizer/lx_anonymizer/craft_text_detection.py,122,text,other,"logger.error(f""Error in CRAFT text detection: {str(e)}"")"
/home/admin/lx-anonymizer/lx_anonymizer/east_text_detection.py,19,text,other,The text region detection provides the starting point for the anonymization pipeline.
/home/admin/lx-anonymizer/lx_anonymizer/east_text_detection.py,27,text,other,"MODEL_URL = ""https://github.com/ZER-0-NE/EAST-Detector-for-text-detection-using-OpenCV/raw/master/frozen_east_text_detection.pb"""
/home/admin/lx-anonymizer/lx_anonymizer/east_text_detection.py,78,text,other,# Load the pre-trained EAST text detector
/home/admin/lx-anonymizer/lx_anonymizer/east_text_detection.py,79,text,other,"logger.debug(""[INFO] Loading EAST text detector..."")"
/home/admin/lx-anonymizer/lx_anonymizer/east_text_detection.py,165,text,other,if min_width <= width <= max_width and min_height <= height <= max_height and width / height < 15:  # Aspect ratio check to avoid long text lines
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,2,uuid,other,import uuid
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,39,text,other,- min_confidence: Minimum confidence for text detection
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,44,text,other,- text_extracted: Optional extracted text from PDF
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,62,text,other,# Extract text from image for LLM analysis
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,65,ocr_text,variable_assignment,ocr_text = pytesseract.image_to_string(image)
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,67,text,other,"logger.warning(f""Failed to extract OCR text: {e}"")"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,68,ocr_text,variable_assignment,"ocr_text = """""
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,70,text,other,# Use LLM to analyze the extracted text
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,71,ocr_text,other,if ocr_text:
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,72,ocr_text,other,llm_metadata = extractor.extract_metadata(ocr_text)
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,75,patient_name,dict_key,"""patient_name"": llm_metadata.patient_name,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,75,patient_name,dict_key,"""patient_name"": llm_metadata.patient_name,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,76,patient_age,dict_key,"""patient_age"": llm_metadata.patient_age,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,76,patient_age,dict_key,"""patient_age"": llm_metadata.patient_age,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,77,examination_date,dict_key,"""examination_date"": llm_metadata.examination_date,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,77,examination_date,dict_key,"""examination_date"": llm_metadata.examination_date,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,79,casenumber,dict_key,"""casenumber"": llm_metadata.casenumber,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,79,casenumber,dict_key,"""casenumber"": llm_metadata.casenumber,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,80,examiner_first_name,dict_key,"""examiner_first_name"": llm_metadata.examiner_first_name,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,80,examiner_first_name,dict_key,"""examiner_first_name"": llm_metadata.examiner_first_name,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,81,examiner_last_name,dict_key,"""examiner_last_name"": llm_metadata.examiner_last_name,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,81,examiner_last_name,dict_key,"""examiner_last_name"": llm_metadata.examiner_last_name,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,88,text,other,# Combine analysis results if we have text
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,94,patient_name,dict_key,"""patient_name"": text_metadata.patient_name,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,94,patient_name,dict_key,"""patient_name"": text_metadata.patient_name,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,95,patient_age,dict_key,"""patient_age"": text_metadata.patient_age,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,95,patient_age,dict_key,"""patient_age"": text_metadata.patient_age,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,96,examination_date,dict_key,"""examination_date"": text_metadata.examination_date,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,96,examination_date,dict_key,"""examination_date"": text_metadata.examination_date,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,98,casenumber,dict_key,"""casenumber"": text_metadata.casenumber,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,98,casenumber,dict_key,"""casenumber"": text_metadata.casenumber,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,99,examiner_first_name,dict_key,"""examiner_first_name"": text_metadata.examiner_first_name,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,99,examiner_first_name,dict_key,"""examiner_first_name"": text_metadata.examiner_first_name,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,100,examiner_last_name,dict_key,"""examiner_last_name"": text_metadata.examiner_last_name,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,100,examiner_last_name,dict_key,"""examiner_last_name"": text_metadata.examiner_last_name,"
/home/admin/lx-anonymizer/lx_anonymizer/image_processor.py,135,uuid,other,"result_path = results_dir / f""processed_{uuid.uuid4()}{file_extension}"""
/home/admin/lx-anonymizer/lx_anonymizer/masking.py,144,text,variable_assignment,"result = subprocess.run(cmd, capture_output=True, text=True, check=True)"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,3,uuid,other,import uuid
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,67,text,other,and checking if it fits using Pillow’s text metrics.
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,93,text,other,"def measure_text_size_pil(text, font):"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,95,text,other,"Returns (width, height) of `text` using Pillow's textbbox."
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,99,text,other,"left, top, right, bottom = draw.textbbox((0, 0), text, font=font)"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,122,text,other,"def draw_text_with_line_break(text, font, font_scale, font_color, font_thickness, background_color, first_name_coords, last_name_coords, line_spacing=20):"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,140,text,other,"names = text.split(""\n"")"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,149,text,attribute_access,"draw.text((first_name_x, first_name_y), first_name, fill=font_color, font=pil_font)"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,151,text,attribute_access,"draw.text((last_name_x, last_name_y), last_name, fill=font_color, font=pil_font)"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,156,text,other,"def draw_text_without_line_break(text, font, font_scale, font_color, font_thickness, background_color, first_name_coords, last_name_coords, line_spacing):"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,158,text,other,Pillow version that draws single-line text in separate regions. Returns a NumPy array (RGB).
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,173,text,other,"names = text.split(""\n"")"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,182,text,attribute_access,"draw.text((first_name_x, first_name_y), first_name, fill=font_color, font=pil_font)"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,184,text,attribute_access,"draw.text((last_name_x, last_name_y), last_name, fill=font_color, font=pil_font)"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,189,text,other,"def draw_free_text(text, font, font_scale, font_color, font_thickness, background_color, first_name_coords, last_name_coords, line_spacing):"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,191,text,other,Another variant that returns a NumPy array. Uses Pillow for text.
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,205,text,other,"names = text.split(""\n"")"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,214,text,attribute_access,"draw.text((first_name_x, first_name_y), first_name, fill=font_color, font=pil_font)"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,216,text,attribute_access,"draw.text((last_name_x, last_name_y), last_name, fill=font_color, font=pil_font)"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,291,uuid,other,unique_id = str(uuid.uuid4())[:8]
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,302,text,other,"def draw_text_to_fit(text, font, box, font_color, font_thickness, background_color):"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,316,text,other,"w, h = measure_text_size_pil(text, test_font)"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,325,text,other,"w, h = measure_text_size_pil(text, final_font)"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,330,text,attribute_access,"draw.text((x, y), text, fill=font_color, font=final_font)"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,330,text,attribute_access,"draw.text((x, y), text, fill=font_color, font=final_font)"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,404,text,other,"def calculate_text_size(text, font_scale, font_thickness):"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,412,text,other,"w, h = measure_text_size_pil(text, test_font)"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,434,text,other,"def draw_text_centered(text, font, font_scale, font_color, font_thickness, background_color, box, padding=10):"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,440,text,other,"text_width, text_height = calculate_text_size(text, font_scale, font_thickness)"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,455,text,attribute_access,"draw.text((x, y), text, fill=font_color, font=pil_font)"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,455,text,attribute_access,"draw.text((x, y), text, fill=font_color, font=pil_font)"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,506,text,other,"raise ValueError(f""No text formatting configuration found for device: {device}"")"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,549,uuid,other,unique_id = str(uuid.uuid4())
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,572,text,other,"# If the text overflows, enlarge"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder.py,581,uuid,other,unique_id = str(uuid.uuid4())[:8]
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,3,uuid,other,import uuid
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,74,text,other,"def draw_text_with_line_break(text, font, font_scale, font_color, font_thickness, background_color, first_name_coords, last_name_coords, line_spacing=20):"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,78,text,other,padding = 10  # Padding around the text
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,85,text,other,"names = text.split(""\n"")"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,101,text,other,"def draw_text_without_line_break(text, font, font_scale, font_color, font_thickness, background_color, first_name_coords, last_name_coords, line_spacing):"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,105,text,other,padding = 10  # Padding around the text
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,112,text,other,"names = text.split(""\n"")"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,128,text,other,"def draw_free_text(text, font, font_scale, font_color, font_thickness, background_color, first_name_coords, last_name_coords, line_spacing):"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,132,text,other,padding = 10  # Padding around the text
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,139,text,other,"names = text.split(""\n"")"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,227,uuid,other,unique_id = str(uuid.uuid4())[:8]
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,236,text,other,"def draw_text_to_fit(text, font, box, font_color, font_thickness, background_color):"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,255,text,other,"text_size = cv2.getTextSize(text, font, font_scale, font_thickness)[0]"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,261,text,other,"text_size = cv2.getTextSize(text, font, font_scale, font_thickness)[0]"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,265,text,other,"cv2.putText(text_img, text, (text_x, text_y), font, font_scale, font_color, font_thickness, lineType=cv2.LINE_AA)"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,267,text,other,# Trim any excess padding while keeping text centered
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,348,text,other,"def calculate_text_size(text, font_scale, font_thickness):"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,351,text,other,for char in text:
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,382,text,other,"def draw_text_centered(text, font, font_scale, font_color, font_thickness, background_color, box, padding=10):"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,383,text,other,# Calculate required text size
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,384,text,other,"text_width, text_height = calculate_text_size(text, font_scale, font_thickness)"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,397,text,other,# Draw text
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,398,text,other,"cv2.putText(text_img, text, (text_x, text_y), font, font_scale, font_color, font_thickness, lineType=cv2.LINE_AA)"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,425,text,other,"raise ValueError(f""No text formatting configuration found for device: {device}"")"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,456,text,other,# Draw text with standardized heights and uniform scale
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,477,uuid,other,unique_id = str(uuid.uuid4())
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,515,text,other,"# If the text overflows, create a larger canvas"
/home/admin/lx-anonymizer/lx_anonymizer/names_adder_cv2.py,526,uuid,other,unique_id = str(uuid.uuid4())[:8]
/home/admin/lx-anonymizer/lx_anonymizer/ocr.py,10,text,other,# Import CRAFT text detection if available (requires hezar)
/home/admin/lx-anonymizer/lx_anonymizer/ocr.py,19,text,other,"raise ImportError(""CRAFT text detection requires 'hezar' package. Install with: pip install lx-anonymizer[llm]"")"
/home/admin/lx-anonymizer/lx_anonymizer/ocr.py,100,text,other,- A single string with all recognized text.
/home/admin/lx-anonymizer/lx_anonymizer/ocr.py,107,text,other,"image = Image.open(image_path).convert(""RGB"")  # 1. Full text in a single chunk"
/home/admin/lx-anonymizer/lx_anonymizer/ocr.py,113,text,other,"for i in range(len(data[""text""])):"
/home/admin/lx-anonymizer/lx_anonymizer/ocr.py,114,text,other,"word = data[""text""][i].strip()"
/home/admin/lx-anonymizer/lx_anonymizer/ocr.py,197,text,other,"image = Image.open(image_path).convert(""RGB"")  # 1. Full text in a single chunk"
/home/admin/lx-anonymizer/lx_anonymizer/ocr.py,199,text,other,# Detect text regions using CRAFT
/home/admin/lx-anonymizer/lx_anonymizer/ocr.py,219,text,other,"logger.debug(f""Box {box} yielded text: '{recognized_text}'"")"
/home/admin/lx-anonymizer/lx_anonymizer/ocr.py,224,text,other,"logger.warning(""No text recognized in regions, falling back to full image OCR."")"
/home/admin/lx-anonymizer/lx_anonymizer/ocr.py,238,text,other,"image = Image.open(image_path).convert(""RGB"")  # 1. Full text in a single chunk"
/home/admin/lx-anonymizer/lx_anonymizer/ocr.py,266,text,other,# Generate text with CUDA optimizations
/home/admin/lx-anonymizer/lx_anonymizer/ocr.py,277,text,other,# Generate text without CUDA optimizations
/home/admin/lx-anonymizer/lx_anonymizer/ocr.py,285,text,other,# Decode the output tokens into readable text
/home/admin/lx-anonymizer/lx_anonymizer/ocr.py,350,text,other,"logger.debug(""Using optimized TesseOCR for text extraction"")"
/home/admin/lx-anonymizer/lx_anonymizer/ocr.py,356,text,other,"logger.debug(""Using pytesseract for text extraction"")"
/home/admin/lx-anonymizer/lx_anonymizer/ocr.py,370,text,other,"image = Image.open(image_path).convert(""RGB"")  # 1. Full text in a single chunk    extracted_text_with_boxes = []"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,54,text,other,str - Combined OCR text result
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,94,text,other,"config = ""--oem 1 --psm 6""  # LSTM only + assume single uniform text block"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,165,text,other,# Check if the selected text is empty or very short
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,189,text,other,str - Combined OCR text
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,203,text,other,"line_sets = {engine: text.split(""\n"") for engine, text in results.items()}"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,203,text,other,"line_sets = {engine: text.split(""\n"") for engine, text in results.items()}"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,235,text,other,def apply_spelling_correction(text: str) -> str:
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,237,text,other,Apply spelling correction to OCR text.
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,240,text,other,text: str - Input text
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,240,text,other,text: str - Input text
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,243,text,other,str - Corrected text
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,246,text,other,return text
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,248,text,other,"lines = text.split(""\n"")"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,323,text,other,"# Assume ocr_function returns (text, confidence)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,324,text,other,"text, confidence = ocr_function(resized_image)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,325,text,other,results.append(text)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,327,text,other,confidence if confidence else len(text) / 100
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,330,text,other,"f""Scale {scale}: confidence {confidence if confidence else 'N/A'}, text length {len(text)}"""
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,330,text,other,"f""Scale {scale}: confidence {confidence if confidence else 'N/A'}, text length {len(text)}"""
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,333,text,other,# If only text is returned
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,334,text,variable_assignment,text = ocr_function(resized_image)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,335,text,other,results.append(text)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,336,text,other,confidences.append(len(text) / 100)  # Use length as confidence proxy
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,337,text,other,"logger.debug(f""Scale {scale}: text length {len(text)}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_ensemble.py,337,text,other,"logger.debug(f""Scale {scale}: text length {len(text)}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame.py,57,text,other,Extract text + confidence + meta from a single frame.
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame.py,58,text,other,"Always returns a (text, confidence, meta) tuple."
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame.py,90,text,other,"for text, conf in zip(data[""text""], data[""conf""]):"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame.py,90,text,other,"for text, conf in zip(data[""text""], data[""conf""]):"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame.py,91,text,other,if text.strip() and int(conf) > 0:
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame.py,92,text,other,words.append(text.strip())
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame.py,95,text,variable_assignment,"text = "" "".join(words)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame.py,97,text,other,"return text, avg_conf, {""words"": len(words), ""avg_conf"": avg_conf}"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,9,text,other,- High-resolution text transcription (state-of-the-art on OCRBench < 25B params)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,10,text,other,- Immediate reasoning over extracted text without fragile handoffs
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,341,text,other,Extract text from image using MiniCPM-o 2.6 vision encoder.
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,348,text,other,Extracted text string
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,361,text,other,"""You are a strict OCR engine. Extract all visible text from this image """
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,362,text,other,"""exactly as it appears, line by line. Output only the raw text without """
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,366,text,other,"prompt = ""Please transcribe the text content visible in this image."""
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,415,text,other,1. Extract all visible text exactly as it appears
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,428,text,dict_key,"""text"": ""extracted text here"","
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,428,text,dict_key,"""text"": ""extracted text here"","
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,431,patient_first_name,dict_key,"""patient_first_name"": ""name or null"","
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,432,patient_last_name,dict_key,"""patient_last_name"": ""name or null"","
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,433,patient_dob,dict_key,"""patient_dob"": ""date or null"","
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,434,casenumber,dict_key,"""casenumber"": ""number or null"","
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,435,examination_date,dict_key,"""examination_date"": ""date or null"","
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,436,examination_time,dict_key,"""examination_time"": ""time or null"""
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,456,text,variable_assignment,"logger.debug(f""MiniCPM unified analysis: sensitive={is_sensitive}, text={transcribed_text[:50]}..."")"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,477,text,other,"# Sometimes the model adds extra text, so look for JSON block"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,489,text,other,"transcribed_text = data.get(""text"", """")"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,505,text,other,# Try to extract at least the text content
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,552,text,other,Extract text from video frame with optional ROI cropping.
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,579,text,other,# Calculate a pseudo-confidence based on text length and metadata richness
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,590,text,other,"logger.error(f""Frame text extraction failed: {e}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,656,text,other,# Create test image with some text
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,668,text,attribute_access,"draw.text((10, 30), ""Test Patient: John Doe"", fill=""black"", font=font)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,673,text,variable_assignment,text = ocr.transcribe_image(test_image)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_minicpm.py,674,text,other,"logger.info(f""Test transcription: {text}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_tesserocr.py,5,text,other,- 10-50x faster text recognition in video processing
/home/admin/lx-anonymizer/lx_anonymizer/ocr_tesserocr.py,68,text,other,# Set optimal parameters for medical text recognition
/home/admin/lx-anonymizer/lx_anonymizer/ocr_tesserocr.py,100,text,other,Process multiple text boxes in an image using optimized Tesseract.
/home/admin/lx-anonymizer/lx_anonymizer/ocr_tesserocr.py,136,text,other,# Extract text directly from C++ API
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,4,uuid,other,import uuid
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,16,text,other,# Import CRAFT text detection if available (requires hezar)
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,25,text,other,"raise ImportError(""CRAFT text detection requires 'hezar' package. Install with: pip install lx-anonymizer[llm]"")"
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,54,text,other,The path to the EAST text detector model. Default is 'frozen_east_text_detection.pb'.
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,56,text,other,The device name to set the correct text settings. Default is 'default'.
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,99,text,variable_assignment,text = page.get_text()
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,100,text,other,if text:
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,101,text,other,extracted_text += text
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,103,uuid,other,"image_path = Path(temp_dir) / f""{uuid.uuid4()}_page_{page_num}.png"""
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,132,text,other,# Extract text from image for LLM analysis
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,135,ocr_text,variable_assignment,ocr_text = pytesseract.image_to_string(image)
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,137,text,other,"logger.warning(f""Failed to extract OCR text: {e}"")"
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,138,ocr_text,variable_assignment,"ocr_text = """""
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,140,text,other,# Use LLM to analyze the extracted text
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,141,ocr_text,other,if ocr_text:
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,142,ocr_text,other,llm_metadata = extractor.extract_metadata(ocr_text)
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,145,patient_name,dict_key,"""patient_name"": llm_metadata.patient_name,"
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,145,patient_name,dict_key,"""patient_name"": llm_metadata.patient_name,"
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,146,patient_age,dict_key,"""patient_age"": llm_metadata.patient_age,"
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,146,patient_age,dict_key,"""patient_age"": llm_metadata.patient_age,"
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,147,examination_date,dict_key,"""examination_date"": llm_metadata.examination_date,"
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,147,examination_date,dict_key,"""examination_date"": llm_metadata.examination_date,"
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,149,casenumber,dict_key,"""casenumber"": llm_metadata.casenumber,"
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,149,casenumber,dict_key,"""casenumber"": llm_metadata.casenumber,"
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,150,examiner_first_name,dict_key,"""examiner_first_name"": llm_metadata.examiner_first_name,"
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,150,examiner_first_name,dict_key,"""examiner_first_name"": llm_metadata.examiner_first_name,"
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,151,examiner_last_name,dict_key,"""examiner_last_name"": llm_metadata.examiner_last_name,"
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,151,examiner_last_name,dict_key,"""examiner_last_name"": llm_metadata.examiner_last_name,"
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,211,uuid,other,"csv_path = csv_dir / f""name_anonymization_data_i{Path(file_path).stem}{uuid.uuid4()}.csv"""
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,213,text,other,"fieldnames = [""filename"", ""startX"", ""startY"", ""endX"", ""endY"", ""text"", ""phrase_box"", ""ocr_confidence"", ""entity_text"", ""entity_tag""]"
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,229,text,dict_key,"""text"": phrase,"
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,251,uuid,other,"output_filename = f""blurred_image_{uuid.uuid4()}.jpg"""
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,337,text,other,"# If you don't have a big list of words, you can pass in your entire recognized text"
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,357,text,other,# 3) Adjust bounding box if the new text is longer
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,360,text,other,# 4) Now feed the (corrected) text + box to your NER and anonymization logic
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,385,uuid,other,"temp_image_path = Path(temp_dir) / f""{uuid.uuid4()}.jpg"""
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,403,text,attribute_access,"all_entities.extend([(entity.text, ""PER"") for entity in flair_entities if entity.tag == ""PER""])"
/home/admin/lx-anonymizer/lx_anonymizer/pipeline_manager.py,420,text,attribute_access,"entities = [(entity.text, ""PER"") for entity in flair_entities if entity.tag == ""PER""]"
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_meta_interface.py,11,patient_first_name,other,patient_first_name: Optional[str] = None
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_meta_interface.py,12,patient_last_name,other,patient_last_name: Optional[str] = None
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_meta_interface.py,13,patient_dob,other,patient_dob: Optional[str] = None
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_meta_interface.py,14,casenumber,other,casenumber: Optional[str] = None
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_meta_interface.py,15,patient_gender,other,patient_gender: Optional[str] = None
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_meta_interface.py,16,examination_date,other,examination_date: Optional[str] = None
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_meta_interface.py,17,examination_time,other,examination_time: Optional[str] = None
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_meta_interface.py,18,examiner_first_name,other,examiner_first_name: Optional[str] = None
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_meta_interface.py,19,examiner_last_name,other,examiner_last_name: Optional[str] = None
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_meta_interface.py,21,text,other,text: Optional[str]=None
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_meta_interface.py,22,anonymized_text,other,anonymized_text: Optional[str] = None
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_meta_interface.py,42,anonymized_text,other,"if not data.get(""anonymized_text"") and data.get(""first_name"") and data.get(""last_name"") and data.get(""text""):"
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_meta_interface.py,42,text,other,"if not data.get(""anonymized_text"") and data.get(""first_name"") and data.get(""last_name"") and data.get(""text""):"
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_meta_interface.py,45,anonymized_text,other,"data[""anonymized_text""] = anonymize_text("
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_meta_interface.py,47,text,variable_assignment,"text=data[""text""],"
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_meta_interface.py,47,text,variable_assignment,"text=data[""text""],"
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_region_cropper.py,53,patient_first_name,dict_key,"""patient_first_name"": r""[A-ZÄÖÜ][a-zäöüß]+\s*,\s*[A-ZÄÖÜ][a-zäöüß]+"""
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_region_cropper.py,54,patient_last_name,dict_key,"""patient_last_name"": r""[A-ZÄÖÜ][a-zäöüß]+\s*,\s*[A-ZÄÖÜ][a-zäöüß]+"","
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_region_cropper.py,56,case_number,dict_key,"""case_number"": r""(?:Fallnummer|Fallnr|Fall\.Nr)[:\s]*(\d+)"","
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_region_cropper.py,60,examiner_first_name,dict_key,"""examiner_first_name"": r""(?:Dr\.\s?(?:med\.\s?)?)?[A-ZÄÖÜ][a-zäöüß]+(?:\s+[A-ZÄÖÜ][a-zäöüß]+)?"","
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_region_cropper.py,61,examiner_last_name,dict_key,"""examiner_last_name"": r""(?:Dr\.\s?(?:med\.\s?)?)?[A-ZÄÖÜ][a-zäöüß]+(?:\s+[A-ZÄÖÜ][a-zäöüß]+)?"""
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_region_cropper.py,320,patient_first_name,other,"if patient_info.get(""patient_first_name"") and patient_info.get("
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_region_cropper.py,321,patient_last_name,other,"""patient_last_name"""
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_region_cropper.py,323,patient_first_name,other,"full_name = f""{patient_info['patient_first_name']} {patient_info['patient_last_name']}"""
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_region_cropper.py,323,patient_last_name,other,"full_name = f""{patient_info['patient_first_name']} {patient_info['patient_last_name']}"""
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_region_cropper.py,333,patient_dob,other,"if patient_info.get(""patient_dob""):"
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_region_cropper.py,334,patient_dob,other,"dob_str = str(patient_info[""patient_dob""])"
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_region_cropper.py,342,casenumber,other,"if patient_info.get(""casenumber""):"
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_region_cropper.py,343,casenumber,other,"case_str = str(patient_info[""casenumber""])"
/home/admin/lx-anonymizer/lx_anonymizer/sensitive_region_cropper.py,520,text,attribute_access,"draw.text((x1, y1 - 20), f""Region {i + 1}"", fill=""red"")"
/home/admin/lx-anonymizer/lx_anonymizer/video_encoder.py,33,text,variable_assignment,"text=True,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,199,patient_first_name,dict_key,"""patient_first_name"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,200,patient_last_name,dict_key,"""patient_last_name"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,201,patient_dob,dict_key,"""patient_dob"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,202,casenumber,dict_key,"""casenumber"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,203,patient_gender,dict_key,"""patient_gender"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,204,examination_date,dict_key,"""examination_date"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,205,examination_time,dict_key,"""examination_time"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,206,examiner_first_name,dict_key,"""examiner_first_name"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,207,examiner_last_name,dict_key,"""examiner_last_name"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,230,ocr_text,other,"is_sensitive, frame_meta, ocr_text, ocr_conf = self._process_frame_single("
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,240,text,variable_assignment,SensitiveMeta.text = ocr_text
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,240,ocr_text,other,SensitiveMeta.text = ocr_text
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,305,text,variable_assignment,"result = subprocess.run(cmd, capture_output=True, text=True, check=True)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,437,text,variable_assignment,"result = subprocess.run(cmd, capture_output=True, text=True, check=True)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,489,text,variable_assignment,"result = subprocess.run(cmd, capture_output=True, text=True, check=True)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,560,text,variable_assignment,"result = subprocess.run(cmd, capture_output=True, text=True, check=True)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,646,text,variable_assignment,"subprocess.run(copy_cmd, capture_output=True, text=True, check=True)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,711,text,variable_assignment,"result = subprocess.run(cmd, capture_output=True, text=True, check=True)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,741,text,variable_assignment,"result = subprocess.run(cmd_no_audio, capture_output=True, text=True, check=True)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,752,text,other,"def _unified_metadata_extract(self, text: str) -> Dict[str, Any]:"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,757,text,other,meta_obj = self.ollama_extractor.extract_metadata(text)
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,766,text,other,meta = self.patient_data_extractor(text)
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,770,text,other,meta = self.frame_metadata_extractor.extract_metadata_from_frame_text(text)
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,785,ocr_text,other,"ocr_text, ocr_conf, frame_metadata, is_sensitive = None, 0.0, {}, False"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,789,ocr_text,other,"#     ocr_text, ocr_conf, frame_metadata, is_sensitive = self._ocr_with_minicpm(gray_frame)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,792,ocr_text,other,"ocr_text, ocr_conf, frame_metadata, is_sensitive = self._ocr_with_tesserocr(gray_frame, endoscope_data_roi_nested)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,795,ocr_text,other,if ocr_text:
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,796,ocr_text,other,meta_unified = self._unified_metadata_extract(ocr_text)
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,800,ocr_text,other,if collect_for_batch and ocr_text:
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,804,ocr_text,dict_key,"""ocr_text"": ocr_text,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,804,ocr_text,dict_key,"""ocr_text"": ocr_text,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,810,ocr_text,other,"return is_sensitive, frame_metadata, ocr_text, ocr_conf"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,825,text,other,"is_sensitive, meta, text, conf = self._process_frame_single("
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,832,text,other,"results.append((is_sensitive, meta, text, conf))"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,838,text,other,"for idx, (is_sensitive, meta, text, conf) in enumerate(results):"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,842,text,other,"text,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,865,text,other,# Use PNG for lossless extraction to preserve text quality
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,889,text,variable_assignment,"result = subprocess.run(cmd, capture_output=True, text=True, check=True)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,923,ocr_text,other,"ocr_text, ocr_conf, _ = self.frame_ocr.extract_text_from_frame("
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,929,ocr_text,other,"logger.debug(f""OCR confidence for {frame_path.name}: {ocr_conf:.3f} OCR Text:{ocr_text}"")"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,931,ocr_text,other,if not ocr_text.strip():
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,932,text,other,"logger.debug(f""No text detected in frame {frame_path.name}"")"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,935,text,other,"logger.debug(f""OCR text from {frame_path.name} (conf={ocr_conf:.3f}): {ocr_text[:100]}..."")"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,935,ocr_text,other,"logger.debug(f""OCR text from {frame_path.name} (conf={ocr_conf:.3f}): {ocr_text[:100]}..."")"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,938,ocr_text,other,patient_info = report_reader.patient_extractor(ocr_text)
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,941,patient_first_name,other,"sensitive_fields = [""patient_first_name"", ""patient_last_name"", ""casenumber""]"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,941,patient_last_name,other,"sensitive_fields = [""patient_first_name"", ""patient_last_name"", ""casenumber""]"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,941,casenumber,other,"sensitive_fields = [""patient_first_name"", ""patient_last_name"", ""casenumber""]"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,979,ocr_text,other,"ocr_text, ocr_conf, _ = self.frame_ocr.extract_text_from_frame("
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,984,ocr_text,other,"logger.debug(f""OCR confidence: {ocr_conf:.3f} OCR Text: {ocr_text[:100]}..."")"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,986,ocr_text,other,if not ocr_text.strip():
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,987,text,other,"logger.debug(f""No text detected in frame {frame_path.name}"")"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,990,text,other,"logger.debug(f""OCR text from {frame_path.name} (conf={ocr_conf:.3f}): {ocr_text[:100]}..."")"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,990,ocr_text,other,"logger.debug(f""OCR text from {frame_path.name} (conf={ocr_conf:.3f}): {ocr_text[:100]}..."")"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,994,ocr_text,other,frame_metadata = self.frame_metadata_extractor.extract_metadata_from_frame_text(ocr_text)
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1014,ocr_text,other,"Yield (ocr_text, avg_confidence) for every frame in frame_paths."
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1017,text,other,"Confidence is normalised to [0,1]. Empty-text frames are skipped."
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1025,ocr_text,other,"ocr_text, avg_conf, _ = self.frame_ocr.extract_text_from_frame("
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1031,ocr_text,other,if not ocr_text.strip():
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1034,ocr_text,other,"yield ocr_text, avg_conf"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1073,text,other,# This can help OCR by making text edges clearer
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1087,text,variable_assignment,"text = (metadata or {}).get(""representative_ocr_text"", """") or """""
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1088,text,other,extracted = self.extract_metadata(text)  # LLM→spaCy
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1098,patient_first_name,dict_key,"""patient_first_name"": merged.get(""patient_first_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1098,patient_first_name,dict_key,"""patient_first_name"": merged.get(""patient_first_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1099,patient_last_name,dict_key,"""patient_last_name"": merged.get(""patient_last_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1099,patient_last_name,dict_key,"""patient_last_name"": merged.get(""patient_last_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1100,patient_dob,dict_key,"""patient_dob"": merged.get(""patient_dob""),"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1100,patient_dob,dict_key,"""patient_dob"": merged.get(""patient_dob""),"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1101,casenumber,dict_key,"""casenumber"": merged.get(""casenumber""),"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1101,casenumber,dict_key,"""casenumber"": merged.get(""casenumber""),"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1102,patient_gender,dict_key,"""patient_gender"": merged.get(""patient_gender""),"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1102,patient_gender,dict_key,"""patient_gender"": merged.get(""patient_gender""),"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1103,examination_date,dict_key,"""examination_date"": merged.get(""examination_date""),"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1103,examination_date,dict_key,"""examination_date"": merged.get(""examination_date""),"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1104,examination_time,dict_key,"""examination_time"": merged.get(""examination_time""),"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1104,examination_time,dict_key,"""examination_time"": merged.get(""examination_time""),"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1105,examiner_first_name,dict_key,"""examiner_first_name"": merged.get(""examiner_first_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1105,examiner_first_name,dict_key,"""examiner_first_name"": merged.get(""examiner_first_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1106,examiner_last_name,dict_key,"""examiner_last_name"": merged.get(""examiner_last_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1106,examiner_last_name,dict_key,"""examiner_last_name"": merged.get(""examiner_last_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1136,text,other,"def extract_metadata(self, text: str) -> Dict[str, Any]:"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1138,text,other,if not text or not text.strip():
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1138,text,other,if not text or not text.strip():
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1141,text,other,"logger.debug(f""Extracting metadata from text of length {len(text)} with content: {text}..."")"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1141,text,other,"logger.debug(f""Extracting metadata from text of length {len(text)} with content: {text}..."")"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1141,text,other,"logger.debug(f""Extracting metadata from text of length {len(text)} with content: {text}..."")"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1147,text,other,meta_obj = self.ollama_extractor.extract_metadata(text)  # type: ignore  # Pydantic-Objekt oder None
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1158,text,other,spacy_meta = self.patient_data_extractor(text)
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1160,text,other,spacy_meta = self.patient_data_extractor.extract(text)
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1162,text,other,spacy_meta = self.patient_data_extractor.patient_extractor(text)
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1236,ocr_text,variable_assignment,"ocr_text = """""
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1237,validated,other,valid_texts = []  # Store only validated text
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1237,text,other,valid_texts = []  # Store only validated text
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1264,ocr_text,other,"ocr_text, ocr_conf, _ = self.frame_ocr.extract_text_from_frame(gray_frame, roi={}, high_quality=True)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1267,ocr_text,other,if self._is_valid_ocr_text(ocr_text):
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1268,ocr_text,other,valid_texts.append(ocr_text)
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1270,text,other,"logger.debug(f""Full-frame OCR produced invalid text, filtering: {ocr_text[:100]}"")"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1270,ocr_text,other,"logger.debug(f""Full-frame OCR produced invalid text, filtering: {ocr_text[:100]}"")"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1271,ocr_text,variable_assignment,"ocr_text = """""
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1283,text,other,"logger.debug(f""ROI {i} produced invalid text (filtered): {output[:50]}"")"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1287,ocr_text,variable_assignment,"ocr_text = ""\n"".join(valid_texts)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1289,text,other,"logger.debug(f""TesserOCR extracted {len(valid_texts)} valid text regions, total length: {len(ocr_text)}, conf: {ocr_conf:.3f}"")"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1289,ocr_text,other,"logger.debug(f""TesserOCR extracted {len(valid_texts)} valid text regions, total length: {len(ocr_text)}, conf: {ocr_conf:.3f}"")"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1292,text,other,# Always try to extract metadata from the combined OCR text
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1293,ocr_text,other,if ocr_text:
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1294,text,other,"logger.debug(""Extracting metadata from combined OCR text"")"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1295,ocr_text,other,extracted_meta = self.frame_metadata_extractor.extract_metadata_from_frame_text(ocr_text)
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1300,ocr_text,other,"return ocr_text, ocr_conf, frame_metadata, is_sensitive"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1306,text,other,"def _is_valid_ocr_text(self, text: str, min_alpha_ratio: float = 0.20, min_length: int = 3) -> bool:"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1308,text,other,Validate OCR text to filter out gibberish.
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1311,text,other,text: OCR extracted text
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1311,text,other,text: OCR extracted text
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1313,text,other,min_length: Minimum text length (default 3)
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1316,text,other,"True if text appears valid, False if likely gibberish"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1318,text,other,if not text or len(text.strip()) < min_length:
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1318,text,other,if not text or len(text.strip()) < min_length:
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1334,text,other,"if re.search(time_pattern, text) or re.search(date_pattern, text) or re.search(case_pattern, text) or re.search(device_pattern, text):"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1334,text,other,"if re.search(time_pattern, text) or re.search(date_pattern, text) or re.search(case_pattern, text) or re.search(device_pattern, text):"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1334,text,other,"if re.search(time_pattern, text) or re.search(date_pattern, text) or re.search(case_pattern, text) or re.search(device_pattern, text):"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1334,text,other,"if re.search(time_pattern, text) or re.search(date_pattern, text) or re.search(case_pattern, text) or re.search(device_pattern, text):"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1339,text,other,alpha_count = sum(c.isalpha() for c in text)
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1340,text,other,alpha_ratio = alpha_count / len(text)
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1348,text,other,nonstandard = sum(1 for c in text if c not in expected_chars)
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1351,text,other,if nonstandard > 0.4 * len(text):
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1355,text,other,words = [w for w in text.split() if len(w) > 1]
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1429,text,variable_assignment,"result = subprocess.run(cmd, capture_output=True, text=True, check=True)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1457,text,variable_assignment,"result = subprocess.run(cmd_no_audio, capture_output=True, text=True, check=True)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1600,text,variable_assignment,"result = subprocess.run(cmd, capture_output=True, text=True, check=True)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1664,ocr_text,variable_assignment,"#         is_sensitive, frame_metadata, ocr_text = self.minicpm_ocr.detect_sensitivity_unified(pil_img, context=""endoscopy video frame"")"
/home/admin/lx-anonymizer/lx_anonymizer/frame_cleaner.py,1666,ocr_text,other,"#         return ocr_text, 1.0, frame_metadata, is_sensitive"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,7,text,other,- Patient data extraction from frame text
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,25,text,other,Specialized metadata extractor for video frame text processing.
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,28,text,other,- Fast pattern matching on frame overlay text
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,35,text,other,# Frame-specific patterns optimized for overlay text
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,87,text,other,"def extract_metadata_from_frame_text(self, text: str) -> Dict[str, Any]:"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,89,text,other,Extract metadata from frame OCR text using specialized patterns.
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,92,text,other,text: OCR-extracted text from frame
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,92,text,other,text: OCR-extracted text from frame
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,98,patient_first_name,dict_key,"""patient_first_name"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,99,patient_last_name,dict_key,"""patient_last_name"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,100,patient_dob,dict_key,"""patient_dob"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,101,casenumber,dict_key,"""casenumber"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,102,patient_gender,dict_key,"""patient_gender"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,103,examination_date,dict_key,"""examination_date"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,104,examination_time,dict_key,"""examination_time"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,105,examiner_first_name,dict_key,"""examiner_first_name"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,106,examiner_last_name,dict_key,"""examiner_last_name"": None,"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,110,text,other,if not text or not text.strip():
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,110,text,other,if not text or not text.strip():
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,115,text,other,"first_name, last_name = self._extract_patient_names(text)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,117,patient_first_name,other,"metadata[""patient_first_name""] = first_name"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,119,patient_last_name,other,"metadata[""patient_last_name""] = last_name"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,122,text,other,dob = self._extract_date_of_birth(text)
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,124,patient_dob,other,"metadata[""patient_dob""] = dob"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,127,text,other,case_num = self._extract_case_number(text)
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,129,casenumber,other,"metadata[""casenumber""] = case_num"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,132,text,other,exam_date = self._extract_examination_date(text)
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,134,examination_date,other,"metadata[""examination_date""] = exam_date"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,137,text,other,exam_time = self._extract_examination_time(text)
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,139,examination_time,other,"metadata[""examination_time""] = exam_time"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,142,text,other,"examiner_first, examiner_last = self._extract_examiner(text)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,144,examiner_first_name,other,"metadata[""examiner_first_name""] = examiner_first"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,146,examiner_last_name,other,"metadata[""examiner_last_name""] = examiner_last"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,149,text,other,gender = self._extract_gender(text)
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,151,patient_gender,other,"metadata[""patient_gender""] = gender"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,159,text,other,"def _extract_patient_names(self, text: str) -> Tuple[Optional[str], Optional[str]]:"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,160,text,other,"""""""Extract patient first and last names from text."""""""
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,163,text,other,"matches = re.findall(pattern, text, re.IGNORECASE)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,171,text,other,"if "","" in text and text.index("","") < text.index(name2):"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,171,text,other,"if "","" in text and text.index("","") < text.index(name2):"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,171,text,other,"if "","" in text and text.index("","") < text.index(name2):"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,187,text,other,"def _extract_date_of_birth(self, text: str) -> Optional[date]:"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,189,text,other,Extract date of birth from text with priority ordering:
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,198,text,other,"matches = re.findall(pattern, text, re.IGNORECASE)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,209,text,other,"matches = re.findall(pattern, text)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,220,text,other,"matches = re.findall(separator_pattern, text)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,270,text,other,"def _extract_case_number(self, text: str) -> Optional[str]:"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,271,text,other,"""""""Extract case number from text."""""""
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,274,text,other,"matches = re.findall(pattern, text, re.IGNORECASE)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,287,text,other,"def _extract_examination_date(self, text: str) -> Optional[date]:"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,288,text,other,"""""""Extract examination date from text."""""""
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,291,text,other,"matches = re.findall(pattern, text, re.IGNORECASE)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,304,text,other,"def _extract_examination_time(self, text: str) -> Optional[str]:"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,305,text,other,"""""""Extract examination time from text."""""""
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,308,text,other,"matches = re.findall(pattern, text, re.IGNORECASE)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,321,text,other,"def _extract_examiner(self, text: str) -> Tuple[Optional[str], Optional[str]]:"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,322,text,other,"""""""Extract examiner first and last name from text."""""""
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,325,text,other,"matches = re.findall(pattern, text, re.IGNORECASE)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,390,text,other,"def _extract_gender(self, text: str) -> Optional[str]:"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,391,text,other,"""""""Extract gender from text."""""""
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,394,text,other,"matches = re.findall(pattern, text, re.IGNORECASE)"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,451,patient_first_name,other,"sensitive_fields = [""patient_first_name"", ""patient_last_name"", ""casenumber""]"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,451,patient_last_name,other,"sensitive_fields = [""patient_first_name"", ""patient_last_name"", ""casenumber""]"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,451,casenumber,other,"sensitive_fields = [""patient_first_name"", ""patient_last_name"", ""casenumber""]"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,469,patient_dob,other,"if metadata.get(""patient_dob""):"
/home/admin/lx-anonymizer/lx_anonymizer/frame_metadata_extractor.py,473,patient_gender,other,"if metadata.get(""patient_gender""):"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,5,text,other,- Detect text-like regions with OpenCV (morph gradient + close + contour filter)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,35,text,other,Now with text-region detection to increase accuracy and reduce gibberish.
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,51,text,other,# Heuristics for text-region detection
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,140,text,other,def _is_gibberish(text: str) -> bool:
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,142,text,other,if not text or len(text) < 3:
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,142,text,other,if not text or len(text) < 3:
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,158,text,other,"if re.search(time_pattern, text) or re.search(date_pattern, text) or re.search(case_pattern, text) or re.search(device_pattern, text):"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,158,text,other,"if re.search(time_pattern, text) or re.search(date_pattern, text) or re.search(case_pattern, text) or re.search(device_pattern, text):"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,158,text,other,"if re.search(time_pattern, text) or re.search(date_pattern, text) or re.search(case_pattern, text) or re.search(device_pattern, text):"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,158,text,other,"if re.search(time_pattern, text) or re.search(date_pattern, text) or re.search(case_pattern, text) or re.search(device_pattern, text):"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,163,text,other,alpha = sum(c.isalpha() for c in text)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,164,text,other,"alpha_ratio = alpha / max(len(text), 1)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,166,text,other,# Reject if too few alphabetic characters (only for non-structured text)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,173,text,other,nonstandard = sum(1 for c in text if c not in expected_chars)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,177,text,other,if nonstandard > 0.4 * len(text):
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,181,text,other,words = text.split()
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,195,text,other,"unique_chars = len(set(text.replace("" "", """")))"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,196,text,other,if unique_chars < len(text) * 0.1:  # Less than 10% unique chars
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,209,text,other,# Tall narrow boxes might be vertical text or single words
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,213,text,other,# Medium boxes are likely single blocks of text
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,217,text,other,# Large boxes might have sparse text (device overlays)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,245,text,other,# 3. Sharpen text edges (helps with blurry video text)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,245,text,other,# 3. Sharpen text edges (helps with blurry video text)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,249,text,other,# 4. Detect if we have white-on-black text (common in medical overlays)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,255,text,other,# Invert for white-on-black text (makes it black-on-white for Tesseract)
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,279,text,other,Detect likely text regions in a grayscale/binary image.
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,336,text,other,# Detect candidate text boxes
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,363,text,variable_assignment,"text = "" "".join(text_parts)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,364,text,variable_assignment,"text = unicodedata.normalize(""NFC"", text)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,364,text,variable_assignment,"text = unicodedata.normalize(""NFC"", text)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,365,text,variable_assignment,"text = re.sub(r""[^\w\s.,:;/-ÄÖÜäöüß]"", """", text)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,365,text,variable_assignment,"text = re.sub(r""[^\w\s.,:;/-ÄÖÜäöüß]"", """", text)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,368,text,other,if self._is_gibberish(text):
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,369,text,other,"logger.debug(f""Detected gibberish, filtering out: {text[:100]}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,370,text,variable_assignment,"text = """""
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,374,text,other,# We approximate by re-measuring on the full image if we produced text from >1 region.
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,375,text,other,if len(regions) > 1 and text:
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,381,text,other,if (not text or conf < 0.3) and regions:
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,398,text,other,"text, conf = retry_text, retry_conf"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,405,text,other,# Normalize and clean text
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,406,text,variable_assignment,"text = unicodedata.normalize(""NFC"", text)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,406,text,variable_assignment,"text = unicodedata.normalize(""NFC"", text)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,407,text,variable_assignment,"text = re.sub(r""[^\w\s.,:;/-ÄÖÜäöüß]"", """", text)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,407,text,variable_assignment,"text = re.sub(r""[^\w\s.,:;/-ÄÖÜäöüß]"", """", text)"
/home/admin/lx-anonymizer/lx_anonymizer/ocr_frame_tesserocr.py,440,text,other,"return text, conf, meta"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,34,patient_name,other,patient_name: str
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,35,patient_age,other,patient_age: int
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,36,examination_date,other,examination_date: str
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,111,text,other,"def _create_extraction_prompt(self, text: str) -> str:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,115,text,other,Text: {text}
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,119,examination_date,other,Verwende für examination_date das Format aus dem Text (DD.MM.YYYY wenn möglich).
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,127,patient_name,dict_key,"""patient_name"": {""type"": ""string""},"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,128,patient_age,dict_key,"""patient_age"": {""type"": ""integer""},"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,129,examination_date,dict_key,"""examination_date"": {""type"": ""string""},"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,133,patient_name,other,"""required"": [""patient_name"", ""patient_age"", ""examination_date"", ""gender""],"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,133,patient_age,other,"""required"": [""patient_name"", ""patient_age"", ""examination_date"", ""gender""],"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,133,examination_date,other,"""required"": [""patient_name"", ""patient_age"", ""examination_date"", ""gender""],"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,146,text,attribute_access,"logger.error(f""API-Fehler {response.status_code}: {response.text}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,170,text,other,"def extract_metadata(self, text: str) -> Optional[PatientMetadata]:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,175,text,other,text: Input-Text zur Extraktion
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,197,text,other,"""messages"": [{""role"": ""user"", ""content"": self._create_extraction_prompt(text)}],"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,217,patient_name,attribute_access,"logger.info(f""Erfolgreich extrahiert: {metadata.patient_name}, Alter: {metadata.patient_age}, Datum: {metadata.examination_date}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,217,patient_age,attribute_access,"logger.info(f""Erfolgreich extrahiert: {metadata.patient_name}, Alter: {metadata.patient_age}, Datum: {metadata.examination_date}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,217,examination_date,attribute_access,"logger.info(f""Erfolgreich extrahiert: {metadata.patient_name}, Alter: {metadata.patient_age}, Datum: {metadata.examination_date}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,256,text,other,def _extract_json_block(text: Optional[str]) -> Optional[str]:
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,257,text,other,"""""""Extract the first valid JSON object embedded within text."""""""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,258,text,other,if not text:
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,261,text,other,"candidate_start = text.find(""{"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,266,text,other,"for idx in range(candidate_start, len(text)):"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,267,text,other,char = text[idx]
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,287,text,other,segment = text[candidate_start : idx + 1]
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,294,text,other,"candidate_start = text.find(""{"", candidate_start + 1)"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,312,text,other,"def regex_extract_llm_meta(self, text: str) -> Dict[str, Any]:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,349,text,other,"text: str,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,366,text,other,"{""role"": ""user"", ""content"": text},"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,427,text,other,"for i, text in enumerate(test_texts, 1):"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,428,text,other,"print(f""\nTest {i}: {text}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,431,text,other,metadata = extractor.extract_metadata(text)
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,436,patient_name,attribute_access,"print(f""   Name: {metadata.patient_name}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,437,patient_age,attribute_access,"print(f""   Alter: {metadata.patient_age}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction.py,438,examination_date,attribute_access,"print(f""   Datum: {metadata.examination_date}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,29,patient_name,other,patient_name: Optional[str] = None
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,30,patient_first_name,other,patient_first_name: Optional[str] = None
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,31,patient_last_name,other,patient_last_name: Optional[str] = None
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,32,patient_age,other,patient_age: Optional[int] = None
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,33,patient_dob,other,patient_dob: Optional[str] = None
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,37,examination_date,other,examination_date: Optional[str] = None
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,38,examination_time,other,examination_time: Optional[str] = None
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,39,examiner_first_name,other,examiner_first_name: Optional[str] = None
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,40,examiner_last_name,other,examiner_last_name: Optional[str] = None
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,43,casenumber,other,casenumber: Optional[str] = None
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,45,patient_id,other,patient_id: Optional[str] = None
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,89,text,other,"def _generate_key(self, text: str) -> str:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,91,text,other,"return hashlib.md5(text.encode(""utf-8"")).hexdigest()[:16]"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,93,text,other,"def get(self, text: str) -> Optional[PatientMetadata]:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,95,text,other,key = self._generate_key(text)
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,104,text,other,"def put(self, text: str, metadata: PatientMetadata):"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,111,text,other,key = self._generate_key(text)
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,182,text,other,"def _create_extraction_prompt(self, text: str) -> str:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,187,text,other,text: Input-Text zur Metadaten-Extraktion
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,197,text,other,{text[:800]}
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,202,patient_name,other,- patient_name: Vollständiger Name des Patienten (Vorname Nachname)
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,203,patient_first_name,other,- patient_first_name: Vorname des Patienten
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,204,patient_last_name,other,- patient_last_name: Nachname des Patienten
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,205,patient_age,other,- patient_age: Alter in Jahren (nur Zahl)
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,206,patient_dob,other,- patient_dob: Geburtsdatum (Format: DD.MM.YYYY oder YYYY-MM-DD)
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,210,examination_date,other,- examination_date: Datum der Untersuchung (Format: DD.MM.YYYY)
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,211,examination_time,other,- examination_time: Uhrzeit der Untersuchung (Format: HH:MM)
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,212,examiner_first_name,other,- examiner_first_name: Vorname des Arztes/Untersuchers
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,213,examiner_last_name,other,- examiner_last_name: Nachname des Arztes/Untersuchers
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,216,casenumber,other,"- casenumber: Fallnummer, Case-ID, Patienten-ID oder ähnliche Kennzeichnung"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,218,patient_id,other,- patient_id: Patienten-Identifikationsnummer
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,236,patient_name,dict_key,"""patient_name"": {""type"": [""string"", ""null""]},"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,237,patient_first_name,dict_key,"""patient_first_name"": {""type"": [""string"", ""null""]},"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,238,patient_last_name,dict_key,"""patient_last_name"": {""type"": [""string"", ""null""]},"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,239,patient_age,dict_key,"""patient_age"": {""type"": [""integer"", ""null""]},"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,240,patient_dob,dict_key,"""patient_dob"": {""type"": [""string"", ""null""]},"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,243,examination_date,dict_key,"""examination_date"": {""type"": [""string"", ""null""]},"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,244,examination_time,dict_key,"""examination_time"": {""type"": [""string"", ""null""]},"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,245,examiner_first_name,dict_key,"""examiner_first_name"": {""type"": [""string"", ""null""]},"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,246,examiner_last_name,dict_key,"""examiner_last_name"": {""type"": [""string"", ""null""]},"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,248,casenumber,dict_key,"""casenumber"": {""type"": [""string"", ""null""]},"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,250,patient_id,dict_key,"""patient_id"": {""type"": [""string"", ""null""]},"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,292,text,attribute_access,"error_msg = f""HTTP {response.status_code}: {response.text[:200]}"""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,329,text,other,"def extract_metadata(self, text: str) -> Optional[PatientMetadata]:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,334,text,other,text: Input-Text zur Extraktion
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,345,text,other,cached_metadata = self.cache.get(text) if self.cache is not None else None
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,371,text,other,"""messages"": [{""role"": ""user"", ""content"": self._create_extraction_prompt(text)}],"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,395,text,other,"self.cache.put(text, metadata)"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,399,patient_name,attribute_access,"f""{metadata.patient_name}, Alter: {metadata.patient_age}, """
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,399,patient_age,attribute_access,"f""{metadata.patient_name}, Alter: {metadata.patient_age}, """
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,400,examination_date,attribute_access,"f""Datum: {metadata.examination_date}"""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,490,text,other,"def extract_metadata_smart_sampling(self, text: str, confidence_threshold: float = 0.7) -> Optional[PatientMetadata]:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,496,text,other,text: Input-Text zur Extraktion
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,503,text,other,if not self._contains_patient_data(text):
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,510,text,other,return self.extract_metadata(text)  # Fallback zur normalen Extraktion
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,517,text,other,truncated_text = text[:200] if len(text) > 200 else text
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,517,text,other,truncated_text = text[:200] if len(text) > 200 else text
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,517,text,other,truncated_text = text[:200] if len(text) > 200 else text
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,549,patient_name,attribute_access,"logger.info(f""✅ Smart-Sampling erfolgreich (Konfidenz: {confidence:.2f}): {metadata.patient_name}, Alter: {metadata.patient_age}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,549,patient_age,attribute_access,"logger.info(f""✅ Smart-Sampling erfolgreich (Konfidenz: {confidence:.2f}): {metadata.patient_name}, Alter: {metadata.patient_age}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,553,text,other,return self.extract_metadata(text)  # Fallback zur vollständigen Extraktion
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,557,text,other,return self.extract_metadata(text)
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,561,text,other,return self.extract_metadata(text)
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,567,text,other,"def _contains_patient_data(self, text: str) -> bool:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,569,text,other,if not text or len(text.strip()) < 10:
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,569,text,other,if not text or len(text.strip()) < 10:
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,598,id,other,"""id"","
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,599,id,other,"""pat-id"","
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,600,id,other,"""patient-id"","
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,602,id,other,"""case-id"","
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,633,text,other,text_lower = text.lower()
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,646,text,other,"def _create_fast_extraction_prompt(self, text: str) -> str:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,650,text,other,TEXT: {text}
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,660,patient_name,dict_key,"{{""patient_name"": ""..."", ""patient_age"": 0, ""examination_date"": ""..."", ""casenumber"": ""..."", ""patient_dob"": ""..."", ""gender"": ""unknown""}}"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,660,patient_age,dict_key,"{{""patient_name"": ""..."", ""patient_age"": 0, ""examination_date"": ""..."", ""casenumber"": ""..."", ""patient_dob"": ""..."", ""gender"": ""unknown""}}"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,660,examination_date,dict_key,"{{""patient_name"": ""..."", ""patient_age"": 0, ""examination_date"": ""..."", ""casenumber"": ""..."", ""patient_dob"": ""..."", ""gender"": ""unknown""}}"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,660,casenumber,dict_key,"{{""patient_name"": ""..."", ""patient_age"": 0, ""examination_date"": ""..."", ""casenumber"": ""..."", ""patient_dob"": ""..."", ""gender"": ""unknown""}}"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,660,patient_dob,dict_key,"{{""patient_name"": ""..."", ""patient_age"": 0, ""examination_date"": ""..."", ""casenumber"": ""..."", ""patient_dob"": ""..."", ""gender"": ""unknown""}}"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,674,patient_name,other,"name = metadata_dict.get(""patient_name"", """") or """""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,675,patient_first_name,other,"first_name = metadata_dict.get(""patient_first_name"", """") or """""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,676,patient_last_name,other,"last_name = metadata_dict.get(""patient_last_name"", """") or """""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,684,patient_age,other,"age = metadata_dict.get(""patient_age"", 0)"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,689,examination_date,other,"exam_date = metadata_dict.get(""examination_date"", """") or """""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,694,casenumber,other,"case_num = metadata_dict.get(""casenumber"", """") or metadata_dict.get(""case_id"", """") or """""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,699,patient_dob,other,"dob = metadata_dict.get(""patient_dob"", """") or """""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,709,examiner_first_name,variable_assignment,"examiner_first_name = metadata_dict.get(""examiner_first_name"", """") or """""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,709,examiner_first_name,variable_assignment,"examiner_first_name = metadata_dict.get(""examiner_first_name"", """") or """""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,710,examiner_first_name,other,"if examiner_first_name and examiner_first_name.lower() not in [""unknown"", """", ""null""]:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,710,examiner_first_name,other,"if examiner_first_name and examiner_first_name.lower() not in [""unknown"", """", ""null""]:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,713,examiner_last_name,variable_assignment,"examiner_last_name = metadata_dict.get(""examiner_last_name"", """") or """""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,713,examiner_last_name,variable_assignment,"examiner_last_name = metadata_dict.get(""examiner_last_name"", """") or """""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,714,examiner_last_name,other,"if examiner_last_name and examiner_last_name.lower() not in [""unknown"", """", ""null""]:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,714,examiner_last_name,other,"if examiner_last_name and examiner_last_name.lower() not in [""unknown"", """", ""null""]:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,718,patient_id,variable_assignment,"patient_id = metadata_dict.get(""patient_id"", """") or """""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,718,patient_id,variable_assignment,"patient_id = metadata_dict.get(""patient_id"", """") or """""
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,719,patient_id,other,"if patient_id and patient_id.lower() not in [""unknown"", """", ""null""]:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,719,patient_id,other,"if patient_id and patient_id.lower() not in [""unknown"", """", ""null""]:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,850,text,other,"for i, text in enumerate(test_texts, 1):"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,851,text,other,"print(f""\nTest {i}: {text}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,854,text,other,metadata = extractor.extract_metadata(text)
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,859,patient_name,attribute_access,"print(f""   Name: {metadata.patient_name}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,860,patient_age,attribute_access,"print(f""   Alter: {metadata.patient_age}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,861,examination_date,attribute_access,"print(f""   Datum: {metadata.examination_date}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,907,patient_name,dict_key,"""patient_name"": llm_metadata.patient_name,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,907,patient_name,dict_key,"""patient_name"": llm_metadata.patient_name,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,908,patient_first_name,dict_key,"""patient_first_name"": llm_metadata.patient_first_name,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,908,patient_first_name,dict_key,"""patient_first_name"": llm_metadata.patient_first_name,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,909,patient_last_name,dict_key,"""patient_last_name"": llm_metadata.patient_last_name,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,909,patient_last_name,dict_key,"""patient_last_name"": llm_metadata.patient_last_name,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,910,patient_age,dict_key,"""patient_age"": llm_metadata.patient_age,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,910,patient_age,dict_key,"""patient_age"": llm_metadata.patient_age,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,911,patient_dob,dict_key,"""patient_dob"": llm_metadata.patient_dob,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,911,patient_dob,dict_key,"""patient_dob"": llm_metadata.patient_dob,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,913,examination_date,dict_key,"""examination_date"": llm_metadata.examination_date,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,913,examination_date,dict_key,"""examination_date"": llm_metadata.examination_date,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,914,examination_time,dict_key,"""examination_time"": llm_metadata.examination_time,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,914,examination_time,dict_key,"""examination_time"": llm_metadata.examination_time,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,915,examiner_first_name,dict_key,"""examiner_first_name"": llm_metadata.examiner_first_name,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,915,examiner_first_name,dict_key,"""examiner_first_name"": llm_metadata.examiner_first_name,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,916,examiner_last_name,dict_key,"""examiner_last_name"": llm_metadata.examiner_last_name,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,916,examiner_last_name,dict_key,"""examiner_last_name"": llm_metadata.examiner_last_name,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,917,casenumber,dict_key,"""casenumber"": llm_metadata.casenumber,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,917,casenumber,dict_key,"""casenumber"": llm_metadata.casenumber,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,919,patient_id,dict_key,"""patient_id"": llm_metadata.patient_id,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,919,patient_id,dict_key,"""patient_id"": llm_metadata.patient_id,"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,963,ocr_text,other,"if ""ocr_text"" in frame_data and frame_data[""ocr_text""]:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,963,ocr_text,other,"if ""ocr_text"" in frame_data and frame_data[""ocr_text""]:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,964,ocr_text,other,"all_texts.append(frame_data[""ocr_text""])"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,983,text,other,for text in texts:
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,984,text,other,if not text or len(text.strip()) < 3:
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,984,text,other,if not text or len(text.strip()) < 3:
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,988,text,other,normalized = text.lower().strip()
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,993,text,other,unique_texts.append(text)
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1001,text,other,"for i, text in enumerate(texts):"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1008,text,other,"text_confidence_pairs.append((text, confidence))"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1013,text,other,"return [text for text, _ in text_confidence_pairs]"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1013,text,other,"return [text for text, _ in text_confidence_pairs]"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1034,ocr_text,other,"if frame_data.get(""ocr_text""):"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1039,ocr_text,other,"""text_snippet"": frame_data[""ocr_text""][:50] + ""..."" if len(frame_data[""ocr_text""]) > 50 else frame_data[""ocr_text""],"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1039,ocr_text,other,"""text_snippet"": frame_data[""ocr_text""][:50] + ""..."" if len(frame_data[""ocr_text""]) > 50 else frame_data[""ocr_text""],"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1039,ocr_text,other,"""text_snippet"": frame_data[""ocr_text""][:50] + ""..."" if len(frame_data[""ocr_text""]) > 50 else frame_data[""ocr_text""],"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1148,ocr_text,dict_key,"""ocr_text"": """","
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1163,ocr_text,other,"# Annahme: (frame_data, ocr_text) oder ähnlich"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1165,ocr_text,other,"normalized[""ocr_text""] = frame_item[1]"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1213,patient_name,other,"logger.info(f""   Patient: {llm_data.get('patient_name', 'Unknown')}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1214,patient_age,other,"logger.info(f""   Alter: {llm_data.get('patient_age', 'Unknown')}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1215,examination_date,other,"logger.info(f""   Datum: {llm_data.get('examination_date', 'Unknown')}"")"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1242,ocr_text,other,"ocr_text, ocr_conf, _ = frame_cleaner_instance.frame_ocr.extract_text_from_frame(gray_frame, roi=None, high_quality=True)"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1248,ocr_text,dict_key,"""ocr_text"": ocr_text or """","
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1248,ocr_text,dict_key,"""ocr_text"": ocr_text or """","
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1250,ocr_text,other,"""has_text"": bool(ocr_text and len(ocr_text.strip()) > 3),"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1250,ocr_text,other,"""has_text"": bool(ocr_text and len(ocr_text.strip()) > 3),"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1329,patient_name,other,"for key in [""patient_name"", ""patient_age"", ""examination_date"", ""gender""]:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1329,patient_age,other,"for key in [""patient_name"", ""patient_age"", ""examination_date"", ""gender""]:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1329,examination_date,other,"for key in [""patient_name"", ""patient_age"", ""examination_date"", ""gender""]:"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1352,patient_name,other,"required_fields = [""patient_name"", ""patient_age"", ""examination_date"", ""gender""]"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1352,patient_age,other,"required_fields = [""patient_name"", ""patient_age"", ""examination_date"", ""gender""]"
/home/admin/lx-anonymizer/lx_anonymizer/ollama_llm_meta_extraction_optimized.py,1352,examination_date,other,"required_fields = [""patient_name"", ""patient_age"", ""examination_date"", ""gender""]"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,98,text,other,Read pdf file using pdfplumber and return the raw text content.
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,121,text,other,# get the text content of the pdf file
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,122,text,variable_assignment,"text = """""
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,126,text,other,"text += page_text + ""\n"""
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,129,text,variable_assignment,"text = "" "".join(text.split())"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,129,text,variable_assignment,"text = "" "".join(text.split())"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,135,text,other,"if re.search(patient_pattern, text):"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,136,text,variable_assignment,"text = re.sub(patient_pattern, r""Patient: \2, \3"", text)"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,136,text,variable_assignment,"text = re.sub(patient_pattern, r""Patient: \2, \3"", text)"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,140,text,other,"if re.search(dob_pattern, text):"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,141,text,variable_assignment,"text = re.sub(dob_pattern, r""geb. \2"", text)"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,141,text,variable_assignment,"text = re.sub(dob_pattern, r""geb. \2"", text)"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,145,text,other,"if re.search(case_pattern, text):"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,146,text,variable_assignment,"text = re.sub(case_pattern, r""Fallnummer: \2"", text)"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,146,text,variable_assignment,"text = re.sub(case_pattern, r""Fallnummer: \2"", text)"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,148,text,other,"logger.debug(f""Enhanced text: {text[:200]}..."")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,148,text,other,"logger.debug(f""Enhanced text: {text[:200]}..."")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,150,text,other,if not text:
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,151,text,other,"warnings.warn(f""Could not read text from {pdf_path}."")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,153,text,other,return text
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,158,text,other,"def extract_report_meta(self, text, pdf_path):"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,160,text,other,Extract metadata from report text using the spacy extractor classes.
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,166,text,other,"logger.debug(f""Full text extracted from PDF: {text[:500]}..."")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,166,text,other,"logger.debug(f""Full text extracted from PDF: {text[:500]}..."")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,167,text,other,"lines = text.split(""\n"") if text else []  # Handle empty text"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,167,text,other,"lines = text.split(""\n"") if text else []  # Handle empty text"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,167,text,other,"lines = text.split(""\n"") if text else []  # Handle empty text"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,170,text,other,# Option 1: Try on whole text with Deepseek
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,172,text,other,if text:
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,173,text,other,patient_info = self.extract_report_meta_deepseek(text)
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,175,text,other,patient_info = self.patient_extractor(text)  # Use __call__
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,176,text,other,"logger.debug(f""Patient extractor result on full text: {patient_info}"")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,178,text,other,"logger.debug(""Skipping extraction on empty text."")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,183,patient_first_name,other,"patient_info.get(""patient_first_name"") is not None or patient_info.get(""patient_last_name"") is not None"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,183,patient_last_name,other,"patient_info.get(""patient_first_name"") is not None or patient_info.get(""patient_last_name"") is not None"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,186,text,other,"# Option 2: If full text failed, try line by line with SpaCy"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,188,text,other,"logger.debug(""Extractor failed on full text, trying line by line."")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,196,patient_first_name,other,"patient_info_line.get(""patient_first_name"") is not None or patient_info_line.get(""patient_last_name"") is not None"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,196,patient_last_name,other,"patient_info_line.get(""patient_first_name"") is not None or patient_info_line.get(""patient_last_name"") is not None"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,203,text,other,if not is_valid_info and text:  # Only run if SpaCy failed AND there is text
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,203,text,other,if not is_valid_info and text:  # Only run if SpaCy failed AND there is text
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,205,text,other,fallback_info = extract_patient_info_from_text(text)  # This fallback might still fail on dotless date
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,207,patient_first_name,other,"if fallback_info.get(""patient_first_name"") != ""Unknown"" or fallback_info.get(""patient_last_name"") != ""Unknown"":"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,207,patient_last_name,other,"if fallback_info.get(""patient_first_name"") != ""Unknown"" or fallback_info.get(""patient_last_name"") != ""Unknown"":"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,210,patient_first_name,other,"fallback_info[""patient_first_name""] = None if fallback_info.get(""patient_first_name"") == ""Unknown"" else fallback_info.get(""patient_first_name"")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,210,patient_first_name,other,"fallback_info[""patient_first_name""] = None if fallback_info.get(""patient_first_name"") == ""Unknown"" else fallback_info.get(""patient_first_name"")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,210,patient_first_name,other,"fallback_info[""patient_first_name""] = None if fallback_info.get(""patient_first_name"") == ""Unknown"" else fallback_info.get(""patient_first_name"")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,211,patient_last_name,other,"fallback_info[""patient_last_name""] = None if fallback_info.get(""patient_last_name"") == ""Unknown"" else fallback_info.get(""patient_last_name"")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,211,patient_last_name,other,"fallback_info[""patient_last_name""] = None if fallback_info.get(""patient_last_name"") == ""Unknown"" else fallback_info.get(""patient_last_name"")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,211,patient_last_name,other,"fallback_info[""patient_last_name""] = None if fallback_info.get(""patient_last_name"") == ""Unknown"" else fallback_info.get(""patient_last_name"")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,212,patient_gender,other,"fallback_info[""patient_gender""] = None if fallback_info.get(""patient_gender"") == ""Unknown"" else fallback_info.get(""patient_gender"")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,212,patient_gender,other,"fallback_info[""patient_gender""] = None if fallback_info.get(""patient_gender"") == ""Unknown"" else fallback_info.get(""patient_gender"")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,212,patient_gender,other,"fallback_info[""patient_gender""] = None if fallback_info.get(""patient_gender"") == ""Unknown"" else fallback_info.get(""patient_gender"")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,222,text,other,# Ensure patient_info is initialized if all methods failed or text was empty
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,228,patient_dob,other,"dob_value = patient_info.get(""patient_dob"")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,252,patient_first_name,dict_key,"""patient_first_name"": patient_info.get(""patient_first_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,252,patient_first_name,dict_key,"""patient_first_name"": patient_info.get(""patient_first_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,253,patient_last_name,dict_key,"""patient_last_name"": patient_info.get(""patient_last_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,253,patient_last_name,dict_key,"""patient_last_name"": patient_info.get(""patient_last_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,254,patient_dob,dict_key,"""patient_dob"": parsed_dob,  # Use the parsed date object or None"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,255,casenumber,dict_key,"""casenumber"": patient_info.get(""casenumber""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,255,casenumber,dict_key,"""casenumber"": patient_info.get(""casenumber""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,256,patient_gender,dict_key,"""patient_gender"": patient_info.get(""patient_gender""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,256,patient_gender,dict_key,"""patient_gender"": patient_info.get(""patient_gender""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,280,examination_date,other,# Ensure examination_date exists before updating
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,281,examination_date,other,"if examination_info.get(""examination_date""):"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,297,hash,other,# Add PDF hash (remains the same)
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,305,hash,other,"logger.warning(f""Cannot calculate PDF hash: invalid or missing pdf_path: {pdf_path}"")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,308,hash,other,"logger.error(f""Could not calculate PDF hash for {pdf_path}: {e}"")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,313,text,other,"def extract_report_meta_deepseek(self, text):"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,322,text,other,meta_obj = self.ollama_extractor.extract_metadata(text)  # type: ignore
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,323,text,other,meta = meta_obj.model_dump() if meta_obj else text
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,331,text,other,return text
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,333,text,other,"def extract_report_meta_medllama(self, text):"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,337,text,other,return text
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,342,text,other,meta_obj = self.ollama_extractor.extract_metadata(text)  # type: ignore
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,343,text,other,meta = meta_obj.model_dump() if meta_obj else text
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,351,text,other,return text
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,353,text,other,"def extract_report_meta_llama3(self, text):"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,357,text,other,return text
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,362,text,other,meta_obj = self.ollama_extractor.extract_metadata(text)  # type: ignore
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,373,text,other,"def anonymize_report(self, text, report_meta):"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,375,text,other,Anonymize the report text using the extracted metadata.
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,377,anonymized_text,variable_assignment,anonymized_text = anonymize_text(
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,378,text,variable_assignment,"text=text,"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,378,text,variable_assignment,"text=text,"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,389,anonymized_text,other,return anonymized_text
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,400,text,variable_assignment,"text=None,"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,405,text,other,"Process a report by extracting text, metadata, and creating an anonymized version."
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,406,text,other,"If the normal pdfplumber extraction fails (or returns very little text), fallback to OCR."
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,416,text,other,"text: Pre-extracted text (optional, will extract from PDF/image if not provided)"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,416,text,other,"text: Pre-extracted text (optional, will extract from PDF/image if not provided)"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,421,anonymized_text,other,"Tuple: (original_text, anonymized_text, report_meta, anonymized_pdf_path)"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,422,text,other,- original_text: Extracted text from the document
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,423,anonymized_text,other,- anonymized_text: Text with sensitive information replaced
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,429,text,other,if text is None:
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,431,text,other,"raise ValueError(""Either 'pdf_path' 'image_path' or 'text' must be provided."")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,439,text,variable_assignment,text = self.read_pdf(pdf_path)
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,448,text,other,"logger.info(f""Reading text from image file: {image_path}"")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,451,text,other,"text, _ = tesseract_full_image_ocr(pil_image)  # Use Tesseract OCR on the image"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,459,text,other,if not text or len(text.strip()) < 50:  # Trigger OCR if text is empty or very short
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,459,text,other,if not text or len(text.strip()) < 50:  # Trigger OCR if text is empty or very short
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,459,text,other,if not text or len(text.strip()) < 50:  # Trigger OCR if text is empty or very short
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,462,text,other,"assert isinstance(text, str)"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,463,text,other,"logger.info(f""Short/No text detected by pdfplumber ({len(text.strip())} chars), applying OCR fallback."")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,463,text,other,"logger.info(f""Short/No text detected by pdfplumber ({len(text.strip())} chars), applying OCR fallback."")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,489,ocr_text,variable_assignment,"ocr_text = """""
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,522,ocr_text,other,"ocr_text += "" "" + ocr_part if ocr_part else """"  # Append only if OCR succeeded"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,524,text,variable_assignment,text = ocr_text.strip()
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,524,ocr_text,other,text = ocr_text.strip()
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,525,text,other,"logger.info(f""OCR fallback finished. Total text length: {len(text)}. Preview: {text[:200]}..."")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,525,text,other,"logger.info(f""OCR fallback finished. Total text length: {len(text)}. Preview: {text[:200]}..."")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,525,text,other,"logger.info(f""OCR fallback finished. Total text length: {len(text)}. Preview: {text[:200]}..."")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,527,text,other,# Apply correction using Ollama (Keep this if you want to correct OCR text)
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,528,text,other,if text and len(text.strip()) > 10:  # Only correct if OCR produced something meaningful
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,528,text,other,if text and len(text.strip()) > 10:  # Only correct if OCR produced something meaningful
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,529,text,other,"logger.info(""Applying LLM correction to OCR text via Ollama"")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,537,text,other,corrected_text = ollama_service.correct_ocr_text_in_chunks(text)  # Use chunking
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,539,text,other,if corrected_text and corrected_text != text and len(corrected_text) > 0.5 * len(text):  # Basic sanity check
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,539,text,other,if corrected_text and corrected_text != text and len(corrected_text) > 0.5 * len(text):  # Basic sanity check
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,540,text,other,"logger.info(""OCR text successfully corrected by Ollama."")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,541,text,variable_assignment,text = corrected_text
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,542,text,other,elif corrected_text == text:
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,543,text,other,"logger.info(""Ollama correction resulted in the same text."")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,545,text,other,"logger.warning(""Ollama OCR correction failed or produced poor result, using original OCR text."")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,549,text,other,if not text or len(text.strip()) < 10:
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,549,text,other,if not text or len(text.strip()) < 10:
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,550,text,other,"logger.error(""OCR fallback produced very short/no text, cannot proceed with metadata extraction."")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,551,text,other,# Return empty/original text and empty meta if OCR fails badly
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,557,text,other,# Return empty/original text and empty meta if OCR fails badly
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,563,text,other,if text and len(text.strip()) >= 10:  # Proceed only if we have some text
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,563,text,other,if text and len(text.strip()) >= 10:  # Proceed only if we have some text
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,563,text,other,if text and len(text.strip()) >= 10:  # Proceed only if we have some text
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,567,text,other,report_meta = self.extract_report_meta_deepseek(text)
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,569,text,other,report_meta = self.extract_report_meta_medllama(text)
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,571,text,other,report_meta = self.extract_report_meta_llama3(text)
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,574,text,other,"report_meta = self.extract_report_meta(text, pdf_path=None)  # Default SpaCy/Regex"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,579,text,other,"report_meta = self.extract_report_meta(text, pdf_path)"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,584,text,other,"report_meta = self.extract_report_meta(text, pdf_path)"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,586,text,other,"logger.warning(""Skipping metadata extraction due to insufficient text content."")"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,587,hash,other,"report_meta = {""pdf_hash"": self.pdf_hash(open(str(pdf_path), ""rb"").read()) if os.path.exists(str(pdf_path)) else None}  # Still add hash if possible"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,590,anonymized_text,variable_assignment,"anonymized_text = self.anonymize_report(text=text, report_meta=report_meta)"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,590,text,variable_assignment,"anonymized_text = self.anonymize_report(text=text, report_meta=report_meta)"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,590,text,variable_assignment,"anonymized_text = self.anonymize_report(text=text, report_meta=report_meta)"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,609,text,other,"assert isinstance(text, str)"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,610,text,other,"report_meta[""text""]=text"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,610,text,other,"report_meta[""text""]=text"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,612,text,other,"report_meta[""text""]=""Unknown"""
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,614,anonymized_text,other,"assert isinstance(anonymized_text, str)"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,615,anonymized_text,other,"report_meta[""anonymized_text""]=anonymized_text"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,615,anonymized_text,other,"report_meta[""anonymized_text""]=anonymized_text"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,617,anonymized_text,other,"report_meta[""anonymized_text""]=""Unknown"""
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,624,patient_first_name,variable_assignment,"patient_first_name=report_meta.get(""patient_first_name"") or report_meta.get(""first_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,624,patient_first_name,variable_assignment,"patient_first_name=report_meta.get(""patient_first_name"") or report_meta.get(""first_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,625,patient_last_name,variable_assignment,"patient_last_name=report_meta.get(""patient_last_name"") or report_meta.get(""last_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,625,patient_last_name,variable_assignment,"patient_last_name=report_meta.get(""patient_last_name"") or report_meta.get(""last_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,626,patient_dob,variable_assignment,"patient_dob=report_meta.get(""patient_dob"") or report_meta.get(""birth_date""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,626,patient_dob,variable_assignment,"patient_dob=report_meta.get(""patient_dob"") or report_meta.get(""birth_date""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,627,casenumber,variable_assignment,"casenumber=report_meta.get(""casenumber"") or report_meta.get(""case_number""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,627,casenumber,variable_assignment,"casenumber=report_meta.get(""casenumber"") or report_meta.get(""case_number""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,627,case_number,other,"casenumber=report_meta.get(""casenumber"") or report_meta.get(""case_number""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,628,patient_gender,variable_assignment,"patient_gender=report_meta.get(""patient_gender"") or report_meta.get(""gender""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,628,patient_gender,variable_assignment,"patient_gender=report_meta.get(""patient_gender"") or report_meta.get(""gender""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,629,examination_date,variable_assignment,"examination_date=report_meta.get(""examination_date""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,629,examination_date,variable_assignment,"examination_date=report_meta.get(""examination_date""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,630,examination_time,variable_assignment,"examination_time=report_meta.get(""examination_time""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,630,examination_time,variable_assignment,"examination_time=report_meta.get(""examination_time""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,631,examiner_first_name,variable_assignment,"examiner_first_name=report_meta.get(""examiner_first_name"") or report_meta.get(""doctor_first_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,631,examiner_first_name,variable_assignment,"examiner_first_name=report_meta.get(""examiner_first_name"") or report_meta.get(""doctor_first_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,631,doctor_first_name,other,"examiner_first_name=report_meta.get(""examiner_first_name"") or report_meta.get(""doctor_first_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,632,examiner_last_name,variable_assignment,"examiner_last_name=report_meta.get(""examiner_last_name"") or report_meta.get(""doctor_last_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,632,examiner_last_name,variable_assignment,"examiner_last_name=report_meta.get(""examiner_last_name"") or report_meta.get(""doctor_last_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,632,doctor_last_name,other,"examiner_last_name=report_meta.get(""examiner_last_name"") or report_meta.get(""doctor_last_name""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,633,hospital,other,"center=report_meta.get(""center"") or report_meta.get(""hospital""),"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,634,text,variable_assignment,"text=text,"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,634,text,variable_assignment,"text=text,"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,635,anonymized_text,variable_assignment,anonymized_text=anonymized_text
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,635,anonymized_text,variable_assignment,anonymized_text=anonymized_text
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,646,text,other,"return text, anonymized_text, sensitive_meta.to_dict(), anonymized_pdf_path"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,646,anonymized_text,other,"return text, anonymized_text, sensitive_meta.to_dict(), anonymized_pdf_path"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,650,hash,other,Calculates the SHA256 hash of a PDF file.
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,657,hash,other,- hash: str
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,658,hash,other,The SHA256 hash of the PDF file.
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,669,text,variable_assignment,"text=None,"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,683,text,other,text: Bereits extrahierter Text (optional)
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,688,anonymized_text,other,"Tuple: (original_text, anonymized_text, report_meta, cropped_regions_info)"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,691,anonymized_text,other,"original_text, anonymized_text, report_meta = self.process_report("
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,692,text,variable_assignment,"pdf_path=pdf_path, image_path=image_path, use_ensemble=use_ensemble, verbose=verbose, use_llm_extractor=use_llm_extractor, text=text"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,692,text,variable_assignment,"pdf_path=pdf_path, image_path=image_path, use_ensemble=use_ensemble, verbose=verbose, use_llm_extractor=use_llm_extractor, text=text"
/home/admin/lx-anonymizer/lx_anonymizer/report_reader.py,753,anonymized_text,other,"return original_text, anonymized_text, report_meta, cropped_regions_info, anonymized_pdf_path"
/home/admin/lx-anonymizer/lx_anonymizer/anonymizer.py,24,text,other,Uses EAST text detection for fast region identification and TesseOCR for
/home/admin/lx-anonymizer/lx_anonymizer/anonymizer.py,25,text,other,accurate text recognition and sensitivity classification.
/home/admin/lx-anonymizer/lx_anonymizer/anonymizer.py,61,text,other,# Step 1: Use EAST for fast text region detection
/home/admin/lx-anonymizer/lx_anonymizer/anonymizer.py,62,text,other,"logger.debug(f""Running EAST text detection on page {page_num + 1}"")"
/home/admin/lx-anonymizer/lx_anonymizer/anonymizer.py,71,text,other,"logger.info(f""No text regions detected on page {page_num + 1}"")"
/home/admin/lx-anonymizer/lx_anonymizer/anonymizer.py,74,text,other,"logger.info(f""EAST detected {len(text_boxes)} text regions on page {page_num + 1}"")"
/home/admin/lx-anonymizer/lx_anonymizer/anonymizer.py,76,text,other,# Step 2: Use TesseOCR for fast and accurate text extraction
/home/admin/lx-anonymizer/lx_anonymizer/anonymizer.py,158,text,other,Uses EAST text detection for fast region identification and TesseOCR for
/home/admin/lx-anonymizer/lx_anonymizer/anonymizer.py,159,text,other,accurate text recognition and sensitivity classification.
/home/admin/lx-anonymizer/lx_anonymizer/anonymizer.py,190,text,other,# Step 1: EAST text detection
/home/admin/lx-anonymizer/lx_anonymizer/anonymizer.py,191,text,other,"logger.debug(""Running EAST text detection on image"")"
/home/admin/lx-anonymizer/lx_anonymizer/anonymizer.py,200,text,other,"logger.info(""No text regions detected."")"
/home/admin/lx-anonymizer/lx_anonymizer/anonymizer.py,203,text,other,"logger.info(f""EAST detected {len(text_boxes)} text regions."")"
/home/admin/lx-anonymizer/lx_anonymizer/str.py,16,text,other,def wrap_first_arg_in_str(text: str) -> str:
/home/admin/lx-anonymizer/lx_anonymizer/str.py,21,text,other,"return pattern.sub(repl, text)"
/home/admin/lx-anonymizer/lx_anonymizer/search.py,25,id,other,"""id"", ""external_id"", ""external_id_origin"", ""hash"", ""uuid"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,25,external_id,other,"""id"", ""external_id"", ""external_id_origin"", ""hash"", ""uuid"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,25,external_id_origin,other,"""id"", ""external_id"", ""external_id_origin"", ""hash"", ""uuid"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,25,hash,other,"""id"", ""external_id"", ""external_id_origin"", ""hash"", ""uuid"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,25,uuid,other,"""id"", ""external_id"", ""external_id_origin"", ""hash"", ""uuid"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,26,patient_hash_display,other,"""patient_hash_display"", ""examination_hash_display"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,26,examination_hash_display,other,"""patient_hash_display"", ""examination_hash_display"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,29,patient_first_name,other,"""patient_first_name"", ""patient_last_name"", ""patient_name"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,29,patient_last_name,other,"""patient_first_name"", ""patient_last_name"", ""patient_name"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,29,patient_name,other,"""patient_first_name"", ""patient_last_name"", ""patient_name"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,30,patient_dob,other,"""patient_dob"", ""patient_dob_display"", ""patient_gender"", ""patient_gender_name"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,30,patient_dob_display,other,"""patient_dob"", ""patient_dob_display"", ""patient_gender"", ""patient_gender_name"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,30,patient_gender,other,"""patient_dob"", ""patient_dob_display"", ""patient_gender"", ""patient_gender_name"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,30,patient_gender_name,other,"""patient_dob"", ""patient_dob_display"", ""patient_gender"", ""patient_gender_name"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,31,patient_age,other,"""patient_age"", ""patient_identifier"", ""patient_number"", ""patient_id"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,31,patient_identifier,other,"""patient_age"", ""patient_identifier"", ""patient_number"", ""patient_id"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,31,patient_number,other,"""patient_age"", ""patient_identifier"", ""patient_number"", ""patient_id"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,31,patient_id,other,"""patient_age"", ""patient_identifier"", ""patient_number"", ""patient_id"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,34,examination_date,other,"""examination_date"", ""examination_date_display"", ""examination_time"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,34,examination_date_display,other,"""examination_date"", ""examination_date_display"", ""examination_time"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,34,examination_time,other,"""examination_date"", ""examination_date_display"", ""examination_time"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,35,examination_id,other,"""examination_id"", ""examination_type"", ""examination_number"", ""examination_status"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,35,examination_type,other,"""examination_id"", ""examination_type"", ""examination_number"", ""examination_status"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,35,examination_number,other,"""examination_id"", ""examination_type"", ""examination_number"", ""examination_status"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,35,examination_status,other,"""examination_id"", ""examination_type"", ""examination_number"", ""examination_status"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,36,examiners_display,other,"""examiners_display"", ""examiner_first_name"", ""examiner_last_name"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,36,examiner_first_name,other,"""examiners_display"", ""examiner_first_name"", ""examiner_last_name"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,36,examiner_last_name,other,"""examiners_display"", ""examiner_first_name"", ""examiner_last_name"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,37,examiner_id,other,"""examiner_id"", ""doctor_first_name"", ""doctor_last_name"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,37,doctor_first_name,other,"""examiner_id"", ""doctor_first_name"", ""doctor_last_name"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,37,doctor_last_name,other,"""examiner_id"", ""doctor_first_name"", ""doctor_last_name"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,40,center_name,other,"""center_name"", ""center_id"", ""hospital"", ""department"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,40,center_id,other,"""center_name"", ""center_id"", ""hospital"", ""department"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,40,hospital,other,"""center_name"", ""center_id"", ""hospital"", ""department"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,40,department,other,"""center_name"", ""center_id"", ""hospital"", ""department"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,41,endoscope_type,other,"""endoscope_type"", ""endoscope_sn"", ""device_id"", ""device_model"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,41,endoscope_sn,other,"""endoscope_type"", ""endoscope_sn"", ""device_id"", ""device_model"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,41,device_id,other,"""endoscope_type"", ""endoscope_sn"", ""device_id"", ""device_model"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,41,device_model,other,"""endoscope_type"", ""endoscope_sn"", ""device_id"", ""device_model"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,44,is_verified,other,"""is_verified"", ""dob_verified"", ""names_verified"", ""metadata_verified"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,44,dob_verified,other,"""is_verified"", ""dob_verified"", ""names_verified"", ""metadata_verified"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,44,names_verified,other,"""is_verified"", ""dob_verified"", ""names_verified"", ""metadata_verified"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,44,metadata_verified,other,"""is_verified"", ""dob_verified"", ""names_verified"", ""metadata_verified"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,45,validated,other,"""validated"", ""validation_status"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,45,validation_status,other,"""validated"", ""validation_status"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,48,text,other,"""text"", ""anonymized_text"", ""raw_text"", ""ocr_text"", ""summary_text"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,48,anonymized_text,other,"""text"", ""anonymized_text"", ""raw_text"", ""ocr_text"", ""summary_text"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,48,raw_text,other,"""text"", ""anonymized_text"", ""raw_text"", ""ocr_text"", ""summary_text"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,48,ocr_text,other,"""text"", ""anonymized_text"", ""raw_text"", ""ocr_text"", ""summary_text"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,48,summary_text,other,"""text"", ""anonymized_text"", ""raw_text"", ""ocr_text"", ""summary_text"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,51,casenumber,other,"""casenumber"", ""case_number"", ""record_number"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,51,case_number,other,"""casenumber"", ""case_number"", ""record_number"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,51,record_number,other,"""casenumber"", ""case_number"", ""record_number"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,52,created_at,other,"""created_at"", ""updated_at"", ""created_by"", ""modified_by"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,52,updated_at,other,"""created_at"", ""updated_at"", ""created_by"", ""modified_by"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,52,created_by,other,"""created_at"", ""updated_at"", ""created_by"", ""modified_by"","
/home/admin/lx-anonymizer/lx_anonymizer/search.py,52,modified_by,other,"""created_at"", ""updated_at"", ""created_by"", ""modified_by"","
/home/admin/lx-anonymizer/lx_anonymizer/utils/text_gen.py,9,text,attribute_access,"# draw.text((x, y),""Sample Text"",(r,g,b))"
/home/admin/lx-anonymizer/lx_anonymizer/utils/text_gen.py,10,text,attribute_access,"draw.text((0, 0),""Sample Text"",(255,255,255),font=font)"
/home/admin/lx-anonymizer/lx_anonymizer/utils/ollama.py,19,text,variable_assignment,"text=True,"
/home/admin/lx-anonymizer/lx_anonymizer/debug/ocr_debug.py,14,text,other,Visualize detected text regions with OCR output overlay.
/home/admin/lx-anonymizer/lx_anonymizer/debug/ocr_debug.py,19,text,other,texts: optional list of OCR text strings per region
/home/admin/lx-anonymizer/lx_anonymizer/debug/ocr_debug.py,45,text,attribute_access,"ax.text(x, y - 3, label, color='yellow', fontsize=7,"
/home/admin/lx-anonymizer/lx_anonymizer/unused_scripts/cropping_and_saving/crop_and_save.py,2,uuid,other,import uuid
/home/admin/lx-anonymizer/lx_anonymizer/unused_scripts/cropping_and_saving/crop_and_save.py,28,text,other,# Generate a unique ID for the extracted text
/home/admin/lx-anonymizer/lx_anonymizer/unused_scripts/cropping_and_saving/crop_and_save.py,29,uuid,other,unique_id = str(uuid.uuid4())
/home/admin/lx-anonymizer/lx_anonymizer/unused_scripts/cropping_and_saving/crop_and_save.py,31,text,other,# Save the extracted text and its unique ID in the dictionary
/home/admin/lx-anonymizer/lx_anonymizer/unused_scripts/cropping_and_saving/crop_and_save.py,34,text,other,"# Optionally, print or save the image path, text, and unique ID to a file"
/home/admin/lx-anonymizer/lx_anonymizer/unused_scripts/cropping_and_saving/crop_and_save.py,37,text,other,# Return both the paths and the text with unique IDs
/home/admin/lx-anonymizer/lx_anonymizer/unused_scripts/for_blurring/color_picker_avg.py,6,text,other,# Crop the background area around the text box
/home/admin/lx-anonymizer/lx_anonymizer/unused_scripts/trying_to_implement_tesseract/tesseract_as_a_function.py,7,text,other,Detects text from an image using Tesseract OCR and EAST detector.
/home/admin/lx-anonymizer/lx_anonymizer/unused_scripts/trying_to_implement_tesseract/tesseract_as_a_function.py,8,text,other,Draws bounding boxes around detected text regions and displays the image.
/home/admin/lx-anonymizer/lx_anonymizer/unused_scripts/trying_to_implement_tesseract/tesseract_as_a_function.py,14,text,other,":return: List of bounding boxes (x, y, w, h) of detected text regions."
/home/admin/lx-anonymizer/lx_anonymizer/unused_scripts/trying_to_implement_tesseract/tesseract_as_a_function.py,28,text,other,# Detecting text using Tesseract
/home/admin/lx-anonymizer/lx_anonymizer/unused_scripts/trying_to_implement_tesseract/tesseract_as_a_function.py,32,text,other,# Loop over each of the individual text localizations
/home/admin/lx-anonymizer/lx_anonymizer/unused_scripts/trying_to_implement_tesseract/tesseract_as_a_function.py,33,text,other,"for i in range(0, len(results[""text""])):"
/home/admin/lx-anonymizer/lx_anonymizer/unused_scripts/trying_to_implement_tesseract/tesseract_as_a_function.py,64,text,other,"help=""path to input EAST text detector"")"
/home/admin/lx-anonymizer/lx_anonymizer/unused_scripts/trying_to_implement_tesseract/tesseract_ocr.py,49,text,other,def clean_newlines(text):
/home/admin/lx-anonymizer/lx_anonymizer/unused_scripts/trying_to_implement_tesseract/tesseract_ocr.py,51,text,other,"cleaned_text = re.sub(r'\n{2,}', '\n', text)"
/home/admin/lx-anonymizer/lx_anonymizer/unused_scripts/trying_to_implement_tesseract/tesseract_ocr.py,203,text,variable_assignment,"text = pytesseract.image_to_string(img, lang='deu')"
/home/admin/lx-anonymizer/lx_anonymizer/unused_scripts/trying_to_implement_tesseract/tesseract_ocr.py,204,text,other,extracted_text += text
/home/admin/lx-anonymizer/lx_anonymizer/unused_scripts/trying_to_implement_tesseract/tesseract_ocr.py,224,text,other,"print(""text detected:"", result)"
